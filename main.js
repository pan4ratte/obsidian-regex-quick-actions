/*
THIS IS A GENERATED/BUNDLED FILE BY ROLLUP
if you want to view the source visit the plugins github repository
*/

'use strict';

var obsidian = require('obsidian');

/******************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */

function __awaiter(thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
}

typeof SuppressedError === "function" ? SuppressedError : function (error, suppressed, message) {
    var e = new Error(message);
    return e.name = "SuppressedError", e.error = error, e.suppressed = suppressed, e;
};

var en = {
    /* Section headers */
    PLUGIN_SETTINGS_HEADER: "Regex Quick Actions settings",
    MANAGE_SECTION_HEADER: "Manage quick actions",
    GENERAL_SECTION_HEADER: "General",
    PLUGIN_DESC: "This plugin allows you to create and quickly apply regex actions via: the command palette, the file context menu in the explorer, the folder context menu in the explorer, the hotkeys. Every saved action becomes a palette command, which ensures automatisation possibilities.",
    /* Generic buttons */
    ADD: "Add",
    SAVE: "Save",
    CANCEL: "Cancel",
    YES: "Yes",
    EDIT: "Edit",
    DELETE: "Delete",
    /* Dialog texts */
    DELETE_HEADER: "Delete quick action",
    DELETE_CONFIRM: "Are you sure you want to delete quick action \"{}\"?",
    FOLDER_ACTION_CONFIRM_TITLE: "Run quick action on folder",
    FOLDER_ACTION_CONFIRM_MSG: "Are you sure that you want to run default quick action on every file inside this folder? This action is irreversible.",
    /* Descriptions */
    PLACEHOLDER_NAME: "Used to call quick actions via command palette",
    PLACEHOLDER_SEARCH: "Search pattern",
    PLACEHOLDER_FLAGS: "e.g. gm",
    PLACEHOLDER_REPLACEMENT: "Replacement text",
    ADD_QUICK_ACTION: "New quick action",
    ACTION_NAME: "Quick action name",
    SEARCH_REGEX: "Regex rule",
    FLAGS: "Flags",
    REPLACEMENT: "Replacement",
    SET_AS_DEFAULT: "Set as default quick action",
    RUN_DEFAULT: "Run default quick action",
    RUN_DEFAULT_ON_FOLDER: "Run default quick action on folder",
    CONFIRM_FOLDER_ACTION: "Confirmation for quick action on folder",
    CONFIRM_FOLDER_ACTION_DESC: "Show a confirmation dialog before running quick action on every file inside a chosen folder.",
    /* Errors and messages */
    NAME_EMPTY_ERR: "Error: Quick action name cannot be empty!",
    NAME_EXISTS_ERR: "Error: An action with this name already exists!",
    PATTERN_EMPTY_ERR: "Error: Regex pattern cannot be empty!",
    FLAGS_INVALID_ERR: "Error: Invalid regex flags provided!",
    REGEX_INVALID_ERR: "Error: Invalid regular expression syntax!",
    NOT_FOUND_ERR: " not found!",
    EXECUTED_MSG: "Executed '{}' with {} replacements."
};

var ru = {
    /* Section headers */
    PLUGIN_SETTINGS_HEADER: "Настройки Regex Quick Actions",
    MANAGE_SECTION_HEADER: "Управление быстрыми командами",
    GENERAL_SECTION_HEADER: "Основные",
    PLUGIN_DESC: "Данный плагин позволяет создавать и быстро применять команды regex через: палитру команд, контекстное меню файла в проводнике, контекстное меню папки в проводнике, контекстное меню активной заметки, сокращения клавиш. Каждая сохранённая команда появляется в палитре команд, что позволяет использовать плагин для автоматизации.",
    /* Generic buttons */
    ADD: "Добавить",
    SAVE: "Сохранить",
    CANCEL: "Отменить",
    YES: "Да",
    EDIT: "Редактировать",
    DELETE: "Удалить",
    /* Dialog texts */
    DELETE_HEADER: "Удалить быструю команду",
    DELETE_CONFIRM: "Вы уверены, что хотите удалить быструю команду \"{}\"?",
    FOLDER_ACTION_CONFIRM_TITLE: "Применить быструю команду к папке",
    FOLDER_ACTION_CONFIRM_MSG: "Вы уверены, что хотите применить быструю команду по умолчанию к каждому файлу внутри этой папки? Это действие нельзя отменить.",
    /* Descriptions */
    PLACEHOLDER_NAME: "Используется для вызова быстрой команды через палитру команд",
    PLACEHOLDER_SEARCH: "Паттерн для поиска",
    PLACEHOLDER_FLAGS: "напр. gm",
    PLACEHOLDER_REPLACEMENT: "Паттерн для замены",
    ADD_QUICK_ACTION: "Новая быстрая команда",
    ACTION_NAME: "Название быстрой команды",
    SEARCH_REGEX: "Правило regex",
    FLAGS: "Флаги",
    REPLACEMENT: "Замена",
    SET_AS_DEFAULT: "Установить как быструю команду по умолчанию",
    RUN_DEFAULT: "Применить быструю команду по умолчанию",
    RUN_DEFAULT_ON_FOLDER: "Применить быструю команду по умолчанию к папке",
    CONFIRM_FOLDER_ACTION: "Подтверждение перед применением быстрой команды к папке",
    CONFIRM_FOLDER_ACTION_DESC: "Показывать диалог подтверждения перед применением быстрой команды к каждому файлу в выбранной папке.",
    /* Errors and messages */
    NAME_EMPTY_ERR: "Ошибка: Имя быстрой команды не может быть пустым!",
    NAME_EXISTS_ERR: "Ошибка: Команда с таким же именем уже существует!",
    PATTERN_EMPTY_ERR: "Ошибка: Паттерн regex не может быть пустым!",
    FLAGS_INVALID_ERR: "Ошибка: Указаны некорректные флаги regex!",
    REGEX_INVALID_ERR: "Ошибка: Некорректный синтаксис регулярного выражения!",
    NOT_FOUND_ERR: " не найдено!",
    EXECUTED_MSG: "Команда '{}' применена с {} заменами."
};

const MESSAGES = {
    en: en,
    ru: ru,
};
const locale = obsidian.moment.locale();
/**
 * Translates a key into the current locale string.
 * @param key - A valid key from the locale files
 * @param args - Values to replace '{}' placeholders in the string
 */
const t = (key, ...args) => {
    // Check if the current locale exists in our MESSAGES, otherwise fallback to English
    const lang = MESSAGES[locale] ? locale : 'en';
    let text = MESSAGES[lang][key] || MESSAGES['en'][key];
    args.forEach(arg => {
        text = text.replace('{}', String(arg));
    });
    return text;
};

const DEFAULT_SETTINGS = {
    rules: [],
    defaultRule: null,
    confirmFolderAction: true
};
class RegexQuickActions extends obsidian.Plugin {
    onload() {
        return __awaiter(this, void 0, void 0, function* () {
            yield this.loadSettings();
            this.pathToRulesets = this.app.vault.configDir + "/regex-rulesets";
            this.addSettingTab(new RegexQuickActionsSettingsTab(this.app, this));
            this.settings.rules.forEach(ruleName => {
                this.addRuleCommand(ruleName);
            });
            this.registerEvent(this.app.workspace.on("file-menu", (menu, file) => {
                if (file instanceof obsidian.TFile && this.settings.defaultRule) {
                    menu.addItem((item) => {
                        item
                            .setTitle(t('RUN_DEFAULT'))
                            .setIcon("play")
                            .onClick(() => __awaiter(this, void 0, void 0, function* () {
                            yield this.applyRulesetToFile(file, this.settings.defaultRule);
                        }));
                    });
                }
                if (file instanceof obsidian.TFolder && this.settings.defaultRule) {
                    menu.addItem((item) => {
                        item
                            .setTitle(t('RUN_DEFAULT_ON_FOLDER'))
                            .setIcon("play")
                            .onClick(() => {
                            const run = () => __awaiter(this, void 0, void 0, function* () {
                                yield this.applyRulesetToFolder(file, this.settings.defaultRule);
                            });
                            if (this.settings.confirmFolderAction) {
                                new ConfirmationModal(this.app, t('FOLDER_ACTION_CONFIRM_TITLE'), t('FOLDER_ACTION_CONFIRM_MSG'), t('YES'), run).open();
                            }
                            else {
                                run();
                            }
                        });
                    });
                }
            }));
            this.registerEvent(this.app.workspace.on("editor-menu", (menu) => {
                if (this.settings.defaultRule) {
                    menu.addItem((item) => {
                        item
                            .setTitle(t('RUN_DEFAULT'))
                            .setIcon("play")
                            .onClick(() => __awaiter(this, void 0, void 0, function* () {
                            yield this.applyRuleset(this.pathToRulesets + "/" + this.settings.defaultRule);
                        }));
                    });
                }
            }));
            yield this.reloadRulesets();
        });
    }
    getCommandId(name) {
        return `apply-rule-${name.toLowerCase().replace(/[^a-z0-9]/g, '-')}`;
    }
    addRuleCommand(name) {
        this.addCommand({
            id: this.getCommandId(name),
            name: `${name}`,
            checkCallback: (checking) => {
                const activeMarkdownView = this.app.workspace.getActiveViewOfType(obsidian.MarkdownView);
                if (activeMarkdownView) {
                    if (!checking) {
                        this.applyRuleset(this.pathToRulesets + "/" + name);
                    }
                    return true;
                }
                return false;
            }
        });
    }
    loadSettings() {
        return __awaiter(this, void 0, void 0, function* () {
            this.settings = Object.assign({}, DEFAULT_SETTINGS, yield this.loadData());
        });
    }
    saveSettings() {
        return __awaiter(this, void 0, void 0, function* () {
            yield this.saveData(this.settings);
        });
    }
    reloadRulesets() {
        return __awaiter(this, void 0, void 0, function* () {
            if (!(yield this.app.vault.adapter.exists(this.pathToRulesets))) {
                yield this.app.vault.createFolder(this.pathToRulesets);
            }
        });
    }
    createRuleset(name, content) {
        return __awaiter(this, void 0, void 0, function* () {
            this.settings.rules.unshift(name);
            const path = this.pathToRulesets + "/" + name;
            yield this.app.vault.adapter.write(path, content);
            yield this.saveSettings();
            this.addRuleCommand(name);
            return true;
        });
    }
    updateRuleset(oldName, newName, content) {
        return __awaiter(this, void 0, void 0, function* () {
            const oldPath = this.pathToRulesets + "/" + oldName;
            const newPath = this.pathToRulesets + "/" + newName;
            yield this.app.vault.adapter.write(newPath, content);
            if (oldName !== newName) {
                if (yield this.app.vault.adapter.exists(oldPath)) {
                    yield this.app.vault.adapter.remove(oldPath);
                }
                this.app.commands.removeCommand(`${this.manifest.id}:${this.getCommandId(oldName)}`);
                const index = this.settings.rules.indexOf(oldName);
                if (index !== -1) {
                    this.settings.rules[index] = newName;
                    if (this.settings.defaultRule === oldName)
                        this.settings.defaultRule = newName;
                    yield this.saveSettings();
                    this.addRuleCommand(newName);
                }
            }
        });
    }
    deleteRuleset(name) {
        return __awaiter(this, void 0, void 0, function* () {
            const path = this.pathToRulesets + "/" + name;
            if (yield this.app.vault.adapter.exists(path)) {
                yield this.app.vault.adapter.remove(path);
            }
            this.app.commands.removeCommand(`${this.manifest.id}:${this.getCommandId(name)}`);
            this.settings.rules = this.settings.rules.filter(r => r !== name);
            if (this.settings.defaultRule === name)
                this.settings.defaultRule = null;
            yield this.saveSettings();
        });
    }
    applyRulesetToFile(file, rulesetName) {
        return __awaiter(this, void 0, void 0, function* () {
            const path = this.pathToRulesets + "/" + rulesetName;
            if (!(yield this.app.vault.adapter.exists(path)))
                return;
            const ruleText = yield this.app.vault.adapter.read(path);
            const count = yield this.modifyFile(file, ruleText, rulesetName);
            new obsidian.Notice(t('EXECUTED_MSG', rulesetName, count));
        });
    }
    applyRulesetToFolder(folder, rulesetName) {
        return __awaiter(this, void 0, void 0, function* () {
            const path = this.pathToRulesets + "/" + rulesetName;
            if (!(yield this.app.vault.adapter.exists(path)))
                return;
            const ruleText = yield this.app.vault.adapter.read(path);
            const files = this.app.vault.getMarkdownFiles().filter(f => f.path.startsWith(folder.path + "/"));
            let totalCount = 0;
            for (const file of files) {
                totalCount += yield this.modifyFile(file, ruleText, rulesetName);
            }
            new obsidian.Notice(t('EXECUTED_MSG', rulesetName, totalCount));
        });
    }
    modifyFile(file, ruleText, rulesetName) {
        var _a;
        return __awaiter(this, void 0, void 0, function* () {
            const activeView = this.app.workspace.getActiveViewOfType(obsidian.MarkdownView);
            if (activeView && ((_a = activeView.file) === null || _a === void 0 ? void 0 : _a.path) === file.path) {
                const editor = activeView.editor;
                const scroll = editor.getScrollInfo();
                const cursor = editor.getCursor();
                const result = this.processRegex(editor.getValue(), ruleText, rulesetName);
                editor.setValue(result.content);
                editor.setCursor(cursor);
                editor.scrollTo(0, scroll.top);
                return result.count;
            }
            else {
                const fileContent = yield this.app.vault.read(file);
                const result = this.processRegex(fileContent, ruleText, rulesetName);
                yield this.app.vault.modify(file, result.content);
                return result.count;
            }
        });
    }
    processRegex(subject, ruleText, rulesetName) {
        const ruleParser = /^"(.+?)"([a-z]*?)(?:\r\n|\r|\n)?->(?:\r\n|\r|\n)?"(.*?)"([a-z]*?)(?:\r\n|\r|\n)?$/gmus;
        let count = 0;
        let ruleMatches;
        let output = subject;
        while ((ruleMatches = ruleParser.exec(ruleText)) !== null) {
            const [, pattern, flags, replacement, mode] = ruleMatches;
            try {
                const matchRule = new RegExp(pattern, flags || 'gm');
                output = mode === 'x' ? output.replace(matchRule, '') : output.replace(matchRule, replacement);
                count++;
            }
            catch (e) {
                console.error(`Regex Quick Actions: Invalid Regex in ${rulesetName}`, e);
            }
        }
        return { content: output, count };
    }
    applyRuleset(rulesetPath) {
        return __awaiter(this, void 0, void 0, function* () {
            if (!(yield this.app.vault.adapter.exists(rulesetPath))) {
                new obsidian.Notice(rulesetPath + t('NOT_FOUND_ERR'));
                return;
            }
            const ruleText = yield this.app.vault.adapter.read(rulesetPath);
            const activeMarkdownView = this.app.workspace.getActiveViewOfType(obsidian.MarkdownView);
            if (!activeMarkdownView)
                return;
            const editor = activeMarkdownView.editor;
            const subject = editor.somethingSelected() ? editor.getSelection() : editor.getValue();
            const pos = editor.getScrollInfo();
            const result = this.processRegex(subject, ruleText, rulesetPath);
            if (editor.somethingSelected())
                editor.replaceSelection(result.content);
            else
                editor.setValue(result.content);
            editor.scrollTo(0, pos.top);
            new obsidian.Notice(t('EXECUTED_MSG', rulesetPath.split('/').pop() || '', result.count));
        });
    }
}
class ConfirmationModal extends obsidian.Modal {
    constructor(app, title, message, confirmBtnText, onConfirm) {
        super(app);
        this.title = title;
        this.message = message;
        this.confirmBtnText = confirmBtnText;
        this.onConfirm = onConfirm;
    }
    onOpen() {
        const { contentEl } = this;
        this.titleEl.setText(this.title);
        contentEl.createEl("p", { text: this.message });
        const btnContainer = contentEl.createEl("div", { cls: "orp-modal-buttons" });
        new obsidian.ButtonComponent(btnContainer).setButtonText(t('CANCEL')).onClick(() => this.close());
        new obsidian.ButtonComponent(btnContainer).setButtonText(this.confirmBtnText).setWarning().onClick(() => {
            this.onConfirm();
            this.close();
        });
    }
    onClose() { this.contentEl.empty(); }
}
class RegexQuickActionsSettingsTab extends obsidian.PluginSettingTab {
    constructor(app, plugin) {
        super(app, plugin);
        this.showCreationForm = false;
        this.editingRule = null;
        this.tempName = "";
        this.tempPattern = "";
        this.tempFlags = "gm";
        this.tempReplacement = "";
        this.tempIsDefault = false;
        this.plugin = plugin;
    }
    display() {
        const { containerEl } = this;
        containerEl.empty();
        new obsidian.Setting(containerEl)
            .setHeading()
            .setName(t('PLUGIN_SETTINGS_HEADER'));
        containerEl.createEl("p", { text: t('PLUGIN_DESC'), cls: "orp-settings-description" });
        new obsidian.Setting(containerEl)
            .setHeading()
            .setName(t('GENERAL_SECTION_HEADER'));
        new obsidian.Setting(containerEl)
            .setName(t('CONFIRM_FOLDER_ACTION'))
            .setDesc(t('CONFIRM_FOLDER_ACTION_DESC'))
            .addToggle(toggle => toggle
            .setValue(this.plugin.settings.confirmFolderAction)
            .onChange((value) => __awaiter(this, void 0, void 0, function* () {
            this.plugin.settings.confirmFolderAction = value;
            yield this.plugin.saveSettings();
        })));
        new obsidian.Setting(containerEl)
            .setHeading()
            .setName(t('MANAGE_SECTION_HEADER'));
        new obsidian.Setting(containerEl)
            .setName(t('ADD_QUICK_ACTION'))
            .addButton(btn => btn
            .setButtonText(t('ADD'))
            .setCta()
            .onClick(() => {
            this.resetTempFields();
            this.showCreationForm = !this.showCreationForm;
            this.display();
        }));
        if (this.showCreationForm) {
            const formContainer = containerEl.createEl("div", { cls: "orp-creation-row" });
            this.renderFormFields(formContainer, () => this.handleSave());
        }
        const listWrapper = containerEl.createEl("div", { cls: "orp-saved-list" });
        this.plugin.settings.rules.forEach((name) => __awaiter(this, void 0, void 0, function* () {
            const itemRow = listWrapper.createEl("div", { cls: "orp-saved-rule-item" });
            if (this.editingRule === name) {
                this.renderFormFields(itemRow, () => this.handleUpdate(name), true);
            }
            else {
                let content = "";
                // FIXED: added comment to empty catch block to satisfy no-empty linter rule
                try {
                    content = yield this.plugin.app.vault.adapter.read(this.plugin.pathToRulesets + "/" + name);
                }
                catch ( /* ignore if file doesn't exist */_a) { /* ignore if file doesn't exist */ }
                const { pattern, flags, replacement } = this.parseRuleContent(content);
                const nameWrap = itemRow.createEl("div", { cls: "orp-input-wrap orp-name-field" });
                nameWrap.createEl("small", { text: t('ACTION_NAME'), cls: "orp-label" });
                nameWrap.createEl("div", { text: name, cls: "orp-saved-text-display" });
                const fieldsRow = itemRow.createEl("div", { cls: "orp-fields-row" });
                this.createDisplayField(fieldsRow, t('SEARCH_REGEX'), pattern, "orp-pattern-field");
                this.createDisplayField(fieldsRow, t('FLAGS'), flags, "orp-flags-field");
                this.createDisplayField(fieldsRow, t('REPLACEMENT'), replacement, "orp-replacement-field");
                const actionsWrap = itemRow.createEl("div", { cls: "orp-input-wrap orp-creation-actions" });
                const defaultWrap = actionsWrap.createEl("div", { cls: "orp-default-toggle-wrap" });
                new obsidian.ToggleComponent(defaultWrap)
                    .setValue(this.plugin.settings.defaultRule === name)
                    .onChange((value) => __awaiter(this, void 0, void 0, function* () {
                    this.plugin.settings.defaultRule = value ? name : null;
                    yield this.plugin.saveSettings();
                    this.display();
                }));
                defaultWrap.createSpan({ text: t('SET_AS_DEFAULT'), cls: "orp-toggle-label" });
                const buttons = actionsWrap.createEl("div", { cls: "orp-action-buttons" });
                new obsidian.ButtonComponent(buttons).setButtonText(t('EDIT')).onClick(() => {
                    this.parseContentToFields(name, content);
                    this.editingRule = name;
                    this.showCreationForm = false;
                    this.display();
                });
                new obsidian.ButtonComponent(buttons).setButtonText(t('DELETE')).setWarning().onClick(() => {
                    new ConfirmationModal(this.app, t('DELETE_HEADER'), t('DELETE_CONFIRM', name), t('YES'), () => __awaiter(this, void 0, void 0, function* () {
                        yield this.plugin.deleteRuleset(name);
                        this.display();
                    })).open();
                });
            }
        }));
    }
    createDisplayField(parent, label, val, cls) {
        const wrap = parent.createEl("div", { cls: `orp-input-wrap ${cls}` });
        wrap.createEl("small", { text: label, cls: "orp-label" });
        wrap.createEl("div", { text: val, cls: "orp-saved-text-display" });
    }
    renderFormFields(container, onConfirm, isUpdate = false) {
        const nameWrap = container.createEl("div", { cls: "orp-input-wrap orp-name-field" });
        nameWrap.createEl("small", { text: t('ACTION_NAME'), cls: "orp-label" });
        this.nameInputEl = nameWrap.createEl("input", { type: "text", value: this.tempName, placeholder: t('PLACEHOLDER_NAME'), cls: "orp-input" });
        this.nameInputEl.addEventListener("input", (e) => this.tempName = e.target.value);
        const fieldsRow = container.createEl("div", { cls: "orp-fields-row" });
        this.patternInputEl = this.createInputField(fieldsRow, t('SEARCH_REGEX'), this.tempPattern, t('PLACEHOLDER_SEARCH'), "orp-pattern-field", (v) => this.tempPattern = v);
        this.flagsInputEl = this.createInputField(fieldsRow, t('FLAGS'), this.tempFlags, t('PLACEHOLDER_FLAGS'), "orp-flags-field", (v) => this.tempFlags = v);
        this.createInputField(fieldsRow, t('REPLACEMENT'), this.tempReplacement, t('PLACEHOLDER_REPLACEMENT'), "orp-replacement-field", (v) => this.tempReplacement = v);
        const actionsWrap = container.createEl("div", { cls: "orp-input-wrap orp-creation-actions" });
        const defaultWrap = actionsWrap.createEl("div", { cls: "orp-default-toggle-wrap" });
        const initialToggleValue = isUpdate ? (this.plugin.settings.defaultRule === this.editingRule) : this.tempIsDefault;
        new obsidian.ToggleComponent(defaultWrap)
            .setValue(initialToggleValue)
            .onChange((value) => __awaiter(this, void 0, void 0, function* () {
            if (isUpdate) {
                this.plugin.settings.defaultRule = value ? this.tempName : null;
                yield this.plugin.saveSettings();
            }
            else {
                this.tempIsDefault = value;
            }
        }));
        defaultWrap.createSpan({ text: t('SET_AS_DEFAULT'), cls: "orp-toggle-label" });
        const buttons = actionsWrap.createEl("div", { cls: "orp-action-buttons" });
        new obsidian.ButtonComponent(buttons).setButtonText(isUpdate ? t('SAVE') : t('SAVE')).setCta().onClick(onConfirm);
        new obsidian.ButtonComponent(buttons).setButtonText(t('CANCEL')).onClick(() => {
            this.editingRule = null;
            this.showCreationForm = false;
            this.display();
        });
    }
    createInputField(parent, label, val, ph, cls, onChange) {
        const wrap = parent.createEl("div", { cls: `orp-input-wrap ${cls}` });
        wrap.createEl("small", { text: label, cls: "orp-label" });
        const input = wrap.createEl("input", { type: "text", value: val, placeholder: ph, cls: "orp-input" });
        input.addEventListener("input", (e) => onChange(e.target.value));
        return input;
    }
    triggerFieldError(el) {
        if (!el)
            return;
        el.classList.remove('field-error');
        void el.offsetWidth;
        el.classList.add('field-error');
    }
    validateInputs(isUpdate = false) {
        const trimmedName = this.tempName.trim();
        if (!trimmedName) {
            new obsidian.Notice(t('NAME_EMPTY_ERR'));
            this.triggerFieldError(this.nameInputEl);
            return false;
        }
        const nameExists = this.plugin.settings.rules.some(name => name.toLowerCase() === trimmedName.toLowerCase() && (!isUpdate || name !== this.editingRule));
        if (nameExists) {
            new obsidian.Notice(t('NAME_EXISTS_ERR'));
            this.triggerFieldError(this.nameInputEl);
            return false;
        }
        if (!this.tempPattern.trim()) {
            new obsidian.Notice(t('PATTERN_EMPTY_ERR'));
            this.triggerFieldError(this.patternInputEl);
            return false;
        }
        try {
            new RegExp(this.tempPattern, this.tempFlags || 'gm');
        }
        catch (e) {
            const errorMsg = e instanceof Error ? e.message.toLowerCase() : String(e).toLowerCase();
            const isFlagError = errorMsg.includes("flag") || /[^gimsuy]/.test(this.tempFlags);
            if (isFlagError) {
                new obsidian.Notice(t('FLAGS_INVALID_ERR'));
                this.triggerFieldError(this.flagsInputEl);
            }
            else {
                new obsidian.Notice(t('REGEX_INVALID_ERR'));
                this.triggerFieldError(this.patternInputEl);
            }
            return false;
        }
        return true;
    }
    handleSave() {
        return __awaiter(this, void 0, void 0, function* () {
            if (!this.validateInputs(false))
                return;
            const content = `"${this.tempPattern}"${this.tempFlags}\n->\n"${this.tempReplacement}"`;
            yield this.plugin.createRuleset(this.tempName, content);
            if (this.tempIsDefault) {
                this.plugin.settings.defaultRule = this.tempName;
                yield this.plugin.saveSettings();
            }
            this.showCreationForm = false;
            this.display();
        });
    }
    handleUpdate(oldName) {
        return __awaiter(this, void 0, void 0, function* () {
            if (!this.validateInputs(true))
                return;
            const content = `"${this.tempPattern}"${this.tempFlags}\n->\n"${this.tempReplacement}"`;
            yield this.plugin.updateRuleset(oldName, this.tempName, content);
            this.editingRule = null;
            this.display();
        });
    }
    parseRuleContent(content) {
        const parser = /^"(.+?)"([a-z]*?)(?:\r\n|\r|\n)?->(?:\r\n|\r|\n)?"(.*?)"([a-z]*?)$/mus;
        const match = parser.exec(content);
        return {
            pattern: match ? match[1] : "",
            flags: match ? match[2] : "gm",
            replacement: match ? match[3] : ""
        };
    }
    parseContentToFields(name, content) {
        const data = this.parseRuleContent(content);
        this.tempName = name;
        this.tempPattern = data.pattern;
        this.tempFlags = data.flags;
        this.tempReplacement = data.replacement;
    }
    resetTempFields() {
        this.tempName = "";
        this.tempPattern = "";
        this.tempFlags = "gm";
        this.tempReplacement = "";
        this.tempIsDefault = false;
        this.editingRule = null;
    }
}

module.exports = RegexQuickActions;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXMiOlsibm9kZV9tb2R1bGVzL3RzbGliL3RzbGliLmVzNi5qcyIsImxvY2FsZXMvZW4udHMiLCJsb2NhbGVzL3J1LnRzIiwiaTE4bi50cyIsIm1haW4udHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxyXG5Db3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi5cclxuXHJcblBlcm1pc3Npb24gdG8gdXNlLCBjb3B5LCBtb2RpZnksIGFuZC9vciBkaXN0cmlidXRlIHRoaXMgc29mdHdhcmUgZm9yIGFueVxyXG5wdXJwb3NlIHdpdGggb3Igd2l0aG91dCBmZWUgaXMgaGVyZWJ5IGdyYW50ZWQuXHJcblxyXG5USEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiIEFORCBUSEUgQVVUSE9SIERJU0NMQUlNUyBBTEwgV0FSUkFOVElFUyBXSVRIXHJcblJFR0FSRCBUTyBUSElTIFNPRlRXQVJFIElOQ0xVRElORyBBTEwgSU1QTElFRCBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWVxyXG5BTkQgRklUTkVTUy4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUiBCRSBMSUFCTEUgRk9SIEFOWSBTUEVDSUFMLCBESVJFQ1QsXHJcbklORElSRUNULCBPUiBDT05TRVFVRU5USUFMIERBTUFHRVMgT1IgQU5ZIERBTUFHRVMgV0hBVFNPRVZFUiBSRVNVTFRJTkcgRlJPTVxyXG5MT1NTIE9GIFVTRSwgREFUQSBPUiBQUk9GSVRTLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgTkVHTElHRU5DRSBPUlxyXG5PVEhFUiBUT1JUSU9VUyBBQ1RJT04sIEFSSVNJTkcgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgVVNFIE9SXHJcblBFUkZPUk1BTkNFIE9GIFRISVMgU09GVFdBUkUuXHJcbioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqICovXHJcbi8qIGdsb2JhbCBSZWZsZWN0LCBQcm9taXNlLCBTdXBwcmVzc2VkRXJyb3IsIFN5bWJvbCwgSXRlcmF0b3IgKi9cclxuXHJcbnZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24oZCwgYikge1xyXG4gICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxyXG4gICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcclxuICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoYiwgcCkpIGRbcF0gPSBiW3BdOyB9O1xyXG4gICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbn07XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19leHRlbmRzKGQsIGIpIHtcclxuICAgIGlmICh0eXBlb2YgYiAhPT0gXCJmdW5jdGlvblwiICYmIGIgIT09IG51bGwpXHJcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNsYXNzIGV4dGVuZHMgdmFsdWUgXCIgKyBTdHJpbmcoYikgKyBcIiBpcyBub3QgYSBjb25zdHJ1Y3RvciBvciBudWxsXCIpO1xyXG4gICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcclxuICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxyXG4gICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xyXG59XHJcblxyXG5leHBvcnQgdmFyIF9fYXNzaWduID0gZnVuY3Rpb24oKSB7XHJcbiAgICBfX2Fzc2lnbiA9IE9iamVjdC5hc3NpZ24gfHwgZnVuY3Rpb24gX19hc3NpZ24odCkge1xyXG4gICAgICAgIGZvciAodmFyIHMsIGkgPSAxLCBuID0gYXJndW1lbnRzLmxlbmd0aDsgaSA8IG47IGkrKykge1xyXG4gICAgICAgICAgICBzID0gYXJndW1lbnRzW2ldO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBwIGluIHMpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwocywgcCkpIHRbcF0gPSBzW3BdO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdDtcclxuICAgIH1cclxuICAgIHJldHVybiBfX2Fzc2lnbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19yZXN0KHMsIGUpIHtcclxuICAgIHZhciB0ID0ge307XHJcbiAgICBmb3IgKHZhciBwIGluIHMpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwocywgcCkgJiYgZS5pbmRleE9mKHApIDwgMClcclxuICAgICAgICB0W3BdID0gc1twXTtcclxuICAgIGlmIChzICE9IG51bGwgJiYgdHlwZW9mIE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMgPT09IFwiZnVuY3Rpb25cIilcclxuICAgICAgICBmb3IgKHZhciBpID0gMCwgcCA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMocyk7IGkgPCBwLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGlmIChlLmluZGV4T2YocFtpXSkgPCAwICYmIE9iamVjdC5wcm90b3R5cGUucHJvcGVydHlJc0VudW1lcmFibGUuY2FsbChzLCBwW2ldKSlcclxuICAgICAgICAgICAgICAgIHRbcFtpXV0gPSBzW3BbaV1dO1xyXG4gICAgICAgIH1cclxuICAgIHJldHVybiB0O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19kZWNvcmF0ZShkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYykge1xyXG4gICAgdmFyIGMgPSBhcmd1bWVudHMubGVuZ3RoLCByID0gYyA8IDMgPyB0YXJnZXQgOiBkZXNjID09PSBudWxsID8gZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBrZXkpIDogZGVzYywgZDtcclxuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5kZWNvcmF0ZSA9PT0gXCJmdW5jdGlvblwiKSByID0gUmVmbGVjdC5kZWNvcmF0ZShkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYyk7XHJcbiAgICBlbHNlIGZvciAodmFyIGkgPSBkZWNvcmF0b3JzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSBpZiAoZCA9IGRlY29yYXRvcnNbaV0pIHIgPSAoYyA8IDMgPyBkKHIpIDogYyA+IDMgPyBkKHRhcmdldCwga2V5LCByKSA6IGQodGFyZ2V0LCBrZXkpKSB8fCByO1xyXG4gICAgcmV0dXJuIGMgPiAzICYmIHIgJiYgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCByKSwgcjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fcGFyYW0ocGFyYW1JbmRleCwgZGVjb3JhdG9yKSB7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRhcmdldCwga2V5KSB7IGRlY29yYXRvcih0YXJnZXQsIGtleSwgcGFyYW1JbmRleCk7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZXNEZWNvcmF0ZShjdG9yLCBkZXNjcmlwdG9ySW4sIGRlY29yYXRvcnMsIGNvbnRleHRJbiwgaW5pdGlhbGl6ZXJzLCBleHRyYUluaXRpYWxpemVycykge1xyXG4gICAgZnVuY3Rpb24gYWNjZXB0KGYpIHsgaWYgKGYgIT09IHZvaWQgMCAmJiB0eXBlb2YgZiAhPT0gXCJmdW5jdGlvblwiKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiRnVuY3Rpb24gZXhwZWN0ZWRcIik7IHJldHVybiBmOyB9XHJcbiAgICB2YXIga2luZCA9IGNvbnRleHRJbi5raW5kLCBrZXkgPSBraW5kID09PSBcImdldHRlclwiID8gXCJnZXRcIiA6IGtpbmQgPT09IFwic2V0dGVyXCIgPyBcInNldFwiIDogXCJ2YWx1ZVwiO1xyXG4gICAgdmFyIHRhcmdldCA9ICFkZXNjcmlwdG9ySW4gJiYgY3RvciA/IGNvbnRleHRJbltcInN0YXRpY1wiXSA/IGN0b3IgOiBjdG9yLnByb3RvdHlwZSA6IG51bGw7XHJcbiAgICB2YXIgZGVzY3JpcHRvciA9IGRlc2NyaXB0b3JJbiB8fCAodGFyZ2V0ID8gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih0YXJnZXQsIGNvbnRleHRJbi5uYW1lKSA6IHt9KTtcclxuICAgIHZhciBfLCBkb25lID0gZmFsc2U7XHJcbiAgICBmb3IgKHZhciBpID0gZGVjb3JhdG9ycy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xyXG4gICAgICAgIHZhciBjb250ZXh0ID0ge307XHJcbiAgICAgICAgZm9yICh2YXIgcCBpbiBjb250ZXh0SW4pIGNvbnRleHRbcF0gPSBwID09PSBcImFjY2Vzc1wiID8ge30gOiBjb250ZXh0SW5bcF07XHJcbiAgICAgICAgZm9yICh2YXIgcCBpbiBjb250ZXh0SW4uYWNjZXNzKSBjb250ZXh0LmFjY2Vzc1twXSA9IGNvbnRleHRJbi5hY2Nlc3NbcF07XHJcbiAgICAgICAgY29udGV4dC5hZGRJbml0aWFsaXplciA9IGZ1bmN0aW9uIChmKSB7IGlmIChkb25lKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGFkZCBpbml0aWFsaXplcnMgYWZ0ZXIgZGVjb3JhdGlvbiBoYXMgY29tcGxldGVkXCIpOyBleHRyYUluaXRpYWxpemVycy5wdXNoKGFjY2VwdChmIHx8IG51bGwpKTsgfTtcclxuICAgICAgICB2YXIgcmVzdWx0ID0gKDAsIGRlY29yYXRvcnNbaV0pKGtpbmQgPT09IFwiYWNjZXNzb3JcIiA/IHsgZ2V0OiBkZXNjcmlwdG9yLmdldCwgc2V0OiBkZXNjcmlwdG9yLnNldCB9IDogZGVzY3JpcHRvcltrZXldLCBjb250ZXh0KTtcclxuICAgICAgICBpZiAoa2luZCA9PT0gXCJhY2Nlc3NvclwiKSB7XHJcbiAgICAgICAgICAgIGlmIChyZXN1bHQgPT09IHZvaWQgMCkgY29udGludWU7XHJcbiAgICAgICAgICAgIGlmIChyZXN1bHQgPT09IG51bGwgfHwgdHlwZW9mIHJlc3VsdCAhPT0gXCJvYmplY3RcIikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIk9iamVjdCBleHBlY3RlZFwiKTtcclxuICAgICAgICAgICAgaWYgKF8gPSBhY2NlcHQocmVzdWx0LmdldCkpIGRlc2NyaXB0b3IuZ2V0ID0gXztcclxuICAgICAgICAgICAgaWYgKF8gPSBhY2NlcHQocmVzdWx0LnNldCkpIGRlc2NyaXB0b3Iuc2V0ID0gXztcclxuICAgICAgICAgICAgaWYgKF8gPSBhY2NlcHQocmVzdWx0LmluaXQpKSBpbml0aWFsaXplcnMudW5zaGlmdChfKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoXyA9IGFjY2VwdChyZXN1bHQpKSB7XHJcbiAgICAgICAgICAgIGlmIChraW5kID09PSBcImZpZWxkXCIpIGluaXRpYWxpemVycy51bnNoaWZ0KF8pO1xyXG4gICAgICAgICAgICBlbHNlIGRlc2NyaXB0b3Jba2V5XSA9IF87XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgaWYgKHRhcmdldCkgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgY29udGV4dEluLm5hbWUsIGRlc2NyaXB0b3IpO1xyXG4gICAgZG9uZSA9IHRydWU7XHJcbn07XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19ydW5Jbml0aWFsaXplcnModGhpc0FyZywgaW5pdGlhbGl6ZXJzLCB2YWx1ZSkge1xyXG4gICAgdmFyIHVzZVZhbHVlID0gYXJndW1lbnRzLmxlbmd0aCA+IDI7XHJcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGluaXRpYWxpemVycy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIHZhbHVlID0gdXNlVmFsdWUgPyBpbml0aWFsaXplcnNbaV0uY2FsbCh0aGlzQXJnLCB2YWx1ZSkgOiBpbml0aWFsaXplcnNbaV0uY2FsbCh0aGlzQXJnKTtcclxuICAgIH1cclxuICAgIHJldHVybiB1c2VWYWx1ZSA/IHZhbHVlIDogdm9pZCAwO1xyXG59O1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fcHJvcEtleSh4KSB7XHJcbiAgICByZXR1cm4gdHlwZW9mIHggPT09IFwic3ltYm9sXCIgPyB4IDogXCJcIi5jb25jYXQoeCk7XHJcbn07XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19zZXRGdW5jdGlvbk5hbWUoZiwgbmFtZSwgcHJlZml4KSB7XHJcbiAgICBpZiAodHlwZW9mIG5hbWUgPT09IFwic3ltYm9sXCIpIG5hbWUgPSBuYW1lLmRlc2NyaXB0aW9uID8gXCJbXCIuY29uY2F0KG5hbWUuZGVzY3JpcHRpb24sIFwiXVwiKSA6IFwiXCI7XHJcbiAgICByZXR1cm4gT2JqZWN0LmRlZmluZVByb3BlcnR5KGYsIFwibmFtZVwiLCB7IGNvbmZpZ3VyYWJsZTogdHJ1ZSwgdmFsdWU6IHByZWZpeCA/IFwiXCIuY29uY2F0KHByZWZpeCwgXCIgXCIsIG5hbWUpIDogbmFtZSB9KTtcclxufTtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX21ldGFkYXRhKG1ldGFkYXRhS2V5LCBtZXRhZGF0YVZhbHVlKSB7XHJcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QubWV0YWRhdGEgPT09IFwiZnVuY3Rpb25cIikgcmV0dXJuIFJlZmxlY3QubWV0YWRhdGEobWV0YWRhdGFLZXksIG1ldGFkYXRhVmFsdWUpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hd2FpdGVyKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xyXG4gICAgZnVuY3Rpb24gYWRvcHQodmFsdWUpIHsgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgUCA/IHZhbHVlIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0pOyB9XHJcbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBhZG9wdChyZXN1bHQudmFsdWUpLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cclxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZ2VuZXJhdG9yKHRoaXNBcmcsIGJvZHkpIHtcclxuICAgIHZhciBfID0geyBsYWJlbDogMCwgc2VudDogZnVuY3Rpb24oKSB7IGlmICh0WzBdICYgMSkgdGhyb3cgdFsxXTsgcmV0dXJuIHRbMV07IH0sIHRyeXM6IFtdLCBvcHM6IFtdIH0sIGYsIHksIHQsIGcgPSBPYmplY3QuY3JlYXRlKCh0eXBlb2YgSXRlcmF0b3IgPT09IFwiZnVuY3Rpb25cIiA/IEl0ZXJhdG9yIDogT2JqZWN0KS5wcm90b3R5cGUpO1xyXG4gICAgcmV0dXJuIGcubmV4dCA9IHZlcmIoMCksIGdbXCJ0aHJvd1wiXSA9IHZlcmIoMSksIGdbXCJyZXR1cm5cIl0gPSB2ZXJiKDIpLCB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgKGdbU3ltYm9sLml0ZXJhdG9yXSA9IGZ1bmN0aW9uKCkgeyByZXR1cm4gdGhpczsgfSksIGc7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgcmV0dXJuIGZ1bmN0aW9uICh2KSB7IHJldHVybiBzdGVwKFtuLCB2XSk7IH07IH1cclxuICAgIGZ1bmN0aW9uIHN0ZXAob3ApIHtcclxuICAgICAgICBpZiAoZikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkdlbmVyYXRvciBpcyBhbHJlYWR5IGV4ZWN1dGluZy5cIik7XHJcbiAgICAgICAgd2hpbGUgKGcgJiYgKGcgPSAwLCBvcFswXSAmJiAoXyA9IDApKSwgXykgdHJ5IHtcclxuICAgICAgICAgICAgaWYgKGYgPSAxLCB5ICYmICh0ID0gb3BbMF0gJiAyID8geVtcInJldHVyblwiXSA6IG9wWzBdID8geVtcInRocm93XCJdIHx8ICgodCA9IHlbXCJyZXR1cm5cIl0pICYmIHQuY2FsbCh5KSwgMCkgOiB5Lm5leHQpICYmICEodCA9IHQuY2FsbCh5LCBvcFsxXSkpLmRvbmUpIHJldHVybiB0O1xyXG4gICAgICAgICAgICBpZiAoeSA9IDAsIHQpIG9wID0gW29wWzBdICYgMiwgdC52YWx1ZV07XHJcbiAgICAgICAgICAgIHN3aXRjaCAob3BbMF0pIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgMDogY2FzZSAxOiB0ID0gb3A7IGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSA0OiBfLmxhYmVsKys7IHJldHVybiB7IHZhbHVlOiBvcFsxXSwgZG9uZTogZmFsc2UgfTtcclxuICAgICAgICAgICAgICAgIGNhc2UgNTogXy5sYWJlbCsrOyB5ID0gb3BbMV07IG9wID0gWzBdOyBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgIGNhc2UgNzogb3AgPSBfLm9wcy5wb3AoKTsgXy50cnlzLnBvcCgpOyBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEodCA9IF8udHJ5cywgdCA9IHQubGVuZ3RoID4gMCAmJiB0W3QubGVuZ3RoIC0gMV0pICYmIChvcFswXSA9PT0gNiB8fCBvcFswXSA9PT0gMikpIHsgXyA9IDA7IGNvbnRpbnVlOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wWzBdID09PSAzICYmICghdCB8fCAob3BbMV0gPiB0WzBdICYmIG9wWzFdIDwgdFszXSkpKSB7IF8ubGFiZWwgPSBvcFsxXTsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAob3BbMF0gPT09IDYgJiYgXy5sYWJlbCA8IHRbMV0pIHsgXy5sYWJlbCA9IHRbMV07IHQgPSBvcDsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAodCAmJiBfLmxhYmVsIDwgdFsyXSkgeyBfLmxhYmVsID0gdFsyXTsgXy5vcHMucHVzaChvcCk7IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRbMl0pIF8ub3BzLnBvcCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIF8udHJ5cy5wb3AoKTsgY29udGludWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgb3AgPSBib2R5LmNhbGwodGhpc0FyZywgXyk7XHJcbiAgICAgICAgfSBjYXRjaCAoZSkgeyBvcCA9IFs2LCBlXTsgeSA9IDA7IH0gZmluYWxseSB7IGYgPSB0ID0gMDsgfVxyXG4gICAgICAgIGlmIChvcFswXSAmIDUpIHRocm93IG9wWzFdOyByZXR1cm4geyB2YWx1ZTogb3BbMF0gPyBvcFsxXSA6IHZvaWQgMCwgZG9uZTogdHJ1ZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgdmFyIF9fY3JlYXRlQmluZGluZyA9IE9iamVjdC5jcmVhdGUgPyAoZnVuY3Rpb24obywgbSwgaywgazIpIHtcclxuICAgIGlmIChrMiA9PT0gdW5kZWZpbmVkKSBrMiA9IGs7XHJcbiAgICB2YXIgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IobSwgayk7XHJcbiAgICBpZiAoIWRlc2MgfHwgKFwiZ2V0XCIgaW4gZGVzYyA/ICFtLl9fZXNNb2R1bGUgOiBkZXNjLndyaXRhYmxlIHx8IGRlc2MuY29uZmlndXJhYmxlKSkge1xyXG4gICAgICAgIGRlc2MgPSB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZnVuY3Rpb24oKSB7IHJldHVybiBtW2tdOyB9IH07XHJcbiAgICB9XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobywgazIsIGRlc2MpO1xyXG59KSA6IChmdW5jdGlvbihvLCBtLCBrLCBrMikge1xyXG4gICAgaWYgKGsyID09PSB1bmRlZmluZWQpIGsyID0gaztcclxuICAgIG9bazJdID0gbVtrXTtcclxufSk7XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19leHBvcnRTdGFyKG0sIG8pIHtcclxuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKHAgIT09IFwiZGVmYXVsdFwiICYmICFPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwobywgcCkpIF9fY3JlYXRlQmluZGluZyhvLCBtLCBwKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fdmFsdWVzKG8pIHtcclxuICAgIHZhciBzID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIFN5bWJvbC5pdGVyYXRvciwgbSA9IHMgJiYgb1tzXSwgaSA9IDA7XHJcbiAgICBpZiAobSkgcmV0dXJuIG0uY2FsbChvKTtcclxuICAgIGlmIChvICYmIHR5cGVvZiBvLmxlbmd0aCA9PT0gXCJudW1iZXJcIikgcmV0dXJuIHtcclxuICAgICAgICBuZXh0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmIChvICYmIGkgPj0gby5sZW5ndGgpIG8gPSB2b2lkIDA7XHJcbiAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcihzID8gXCJPYmplY3QgaXMgbm90IGl0ZXJhYmxlLlwiIDogXCJTeW1ib2wuaXRlcmF0b3IgaXMgbm90IGRlZmluZWQuXCIpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19yZWFkKG8sIG4pIHtcclxuICAgIHZhciBtID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIG9bU3ltYm9sLml0ZXJhdG9yXTtcclxuICAgIGlmICghbSkgcmV0dXJuIG87XHJcbiAgICB2YXIgaSA9IG0uY2FsbChvKSwgciwgYXIgPSBbXSwgZTtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgd2hpbGUgKChuID09PSB2b2lkIDAgfHwgbi0tID4gMCkgJiYgIShyID0gaS5uZXh0KCkpLmRvbmUpIGFyLnB1c2goci52YWx1ZSk7XHJcbiAgICB9XHJcbiAgICBjYXRjaCAoZXJyb3IpIHsgZSA9IHsgZXJyb3I6IGVycm9yIH07IH1cclxuICAgIGZpbmFsbHkge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGlmIChyICYmICFyLmRvbmUgJiYgKG0gPSBpW1wicmV0dXJuXCJdKSkgbS5jYWxsKGkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmaW5hbGx5IHsgaWYgKGUpIHRocm93IGUuZXJyb3I7IH1cclxuICAgIH1cclxuICAgIHJldHVybiBhcjtcclxufVxyXG5cclxuLyoqIEBkZXByZWNhdGVkICovXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3NwcmVhZCgpIHtcclxuICAgIGZvciAodmFyIGFyID0gW10sIGkgPSAwOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKVxyXG4gICAgICAgIGFyID0gYXIuY29uY2F0KF9fcmVhZChhcmd1bWVudHNbaV0pKTtcclxuICAgIHJldHVybiBhcjtcclxufVxyXG5cclxuLyoqIEBkZXByZWNhdGVkICovXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3NwcmVhZEFycmF5cygpIHtcclxuICAgIGZvciAodmFyIHMgPSAwLCBpID0gMCwgaWwgPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgaWw7IGkrKykgcyArPSBhcmd1bWVudHNbaV0ubGVuZ3RoO1xyXG4gICAgZm9yICh2YXIgciA9IEFycmF5KHMpLCBrID0gMCwgaSA9IDA7IGkgPCBpbDsgaSsrKVxyXG4gICAgICAgIGZvciAodmFyIGEgPSBhcmd1bWVudHNbaV0sIGogPSAwLCBqbCA9IGEubGVuZ3RoOyBqIDwgamw7IGorKywgaysrKVxyXG4gICAgICAgICAgICByW2tdID0gYVtqXTtcclxuICAgIHJldHVybiByO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19zcHJlYWRBcnJheSh0bywgZnJvbSwgcGFjaykge1xyXG4gICAgaWYgKHBhY2sgfHwgYXJndW1lbnRzLmxlbmd0aCA9PT0gMikgZm9yICh2YXIgaSA9IDAsIGwgPSBmcm9tLmxlbmd0aCwgYXI7IGkgPCBsOyBpKyspIHtcclxuICAgICAgICBpZiAoYXIgfHwgIShpIGluIGZyb20pKSB7XHJcbiAgICAgICAgICAgIGlmICghYXIpIGFyID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZnJvbSwgMCwgaSk7XHJcbiAgICAgICAgICAgIGFyW2ldID0gZnJvbVtpXTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdG8uY29uY2F0KGFyIHx8IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGZyb20pKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXdhaXQodikge1xyXG4gICAgcmV0dXJuIHRoaXMgaW5zdGFuY2VvZiBfX2F3YWl0ID8gKHRoaXMudiA9IHYsIHRoaXMpIDogbmV3IF9fYXdhaXQodik7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jR2VuZXJhdG9yKHRoaXNBcmcsIF9hcmd1bWVudHMsIGdlbmVyYXRvcikge1xyXG4gICAgaWYgKCFTeW1ib2wuYXN5bmNJdGVyYXRvcikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN5bWJvbC5hc3luY0l0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLlwiKTtcclxuICAgIHZhciBnID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pLCBpLCBxID0gW107XHJcbiAgICByZXR1cm4gaSA9IE9iamVjdC5jcmVhdGUoKHR5cGVvZiBBc3luY0l0ZXJhdG9yID09PSBcImZ1bmN0aW9uXCIgPyBBc3luY0l0ZXJhdG9yIDogT2JqZWN0KS5wcm90b3R5cGUpLCB2ZXJiKFwibmV4dFwiKSwgdmVyYihcInRocm93XCIpLCB2ZXJiKFwicmV0dXJuXCIsIGF3YWl0UmV0dXJuKSwgaVtTeW1ib2wuYXN5bmNJdGVyYXRvcl0gPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9LCBpO1xyXG4gICAgZnVuY3Rpb24gYXdhaXRSZXR1cm4oZikgeyByZXR1cm4gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh2KS50aGVuKGYsIHJlamVjdCk7IH07IH1cclxuICAgIGZ1bmN0aW9uIHZlcmIobiwgZikgeyBpZiAoZ1tuXSkgeyBpW25dID0gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChhLCBiKSB7IHEucHVzaChbbiwgdiwgYSwgYl0pID4gMSB8fCByZXN1bWUobiwgdik7IH0pOyB9OyBpZiAoZikgaVtuXSA9IGYoaVtuXSk7IH0gfVxyXG4gICAgZnVuY3Rpb24gcmVzdW1lKG4sIHYpIHsgdHJ5IHsgc3RlcChnW25dKHYpKTsgfSBjYXRjaCAoZSkgeyBzZXR0bGUocVswXVszXSwgZSk7IH0gfVxyXG4gICAgZnVuY3Rpb24gc3RlcChyKSB7IHIudmFsdWUgaW5zdGFuY2VvZiBfX2F3YWl0ID8gUHJvbWlzZS5yZXNvbHZlKHIudmFsdWUudikudGhlbihmdWxmaWxsLCByZWplY3QpIDogc2V0dGxlKHFbMF1bMl0sIHIpOyB9XHJcbiAgICBmdW5jdGlvbiBmdWxmaWxsKHZhbHVlKSB7IHJlc3VtZShcIm5leHRcIiwgdmFsdWUpOyB9XHJcbiAgICBmdW5jdGlvbiByZWplY3QodmFsdWUpIHsgcmVzdW1lKFwidGhyb3dcIiwgdmFsdWUpOyB9XHJcbiAgICBmdW5jdGlvbiBzZXR0bGUoZiwgdikgeyBpZiAoZih2KSwgcS5zaGlmdCgpLCBxLmxlbmd0aCkgcmVzdW1lKHFbMF1bMF0sIHFbMF1bMV0pOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jRGVsZWdhdG9yKG8pIHtcclxuICAgIHZhciBpLCBwO1xyXG4gICAgcmV0dXJuIGkgPSB7fSwgdmVyYihcIm5leHRcIiksIHZlcmIoXCJ0aHJvd1wiLCBmdW5jdGlvbiAoZSkgeyB0aHJvdyBlOyB9KSwgdmVyYihcInJldHVyblwiKSwgaVtTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSwgaTtcclxuICAgIGZ1bmN0aW9uIHZlcmIobiwgZikgeyBpW25dID0gb1tuXSA/IGZ1bmN0aW9uICh2KSB7IHJldHVybiAocCA9ICFwKSA/IHsgdmFsdWU6IF9fYXdhaXQob1tuXSh2KSksIGRvbmU6IGZhbHNlIH0gOiBmID8gZih2KSA6IHY7IH0gOiBmOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jVmFsdWVzKG8pIHtcclxuICAgIGlmICghU3ltYm9sLmFzeW5jSXRlcmF0b3IpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJTeW1ib2wuYXN5bmNJdGVyYXRvciBpcyBub3QgZGVmaW5lZC5cIik7XHJcbiAgICB2YXIgbSA9IG9bU3ltYm9sLmFzeW5jSXRlcmF0b3JdLCBpO1xyXG4gICAgcmV0dXJuIG0gPyBtLmNhbGwobykgOiAobyA9IHR5cGVvZiBfX3ZhbHVlcyA9PT0gXCJmdW5jdGlvblwiID8gX192YWx1ZXMobykgOiBvW1N5bWJvbC5pdGVyYXRvcl0oKSwgaSA9IHt9LCB2ZXJiKFwibmV4dFwiKSwgdmVyYihcInRocm93XCIpLCB2ZXJiKFwicmV0dXJuXCIpLCBpW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGkpO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IGlbbl0gPSBvW25dICYmIGZ1bmN0aW9uICh2KSB7IHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7IHYgPSBvW25dKHYpLCBzZXR0bGUocmVzb2x2ZSwgcmVqZWN0LCB2LmRvbmUsIHYudmFsdWUpOyB9KTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gc2V0dGxlKHJlc29sdmUsIHJlamVjdCwgZCwgdikgeyBQcm9taXNlLnJlc29sdmUodikudGhlbihmdW5jdGlvbih2KSB7IHJlc29sdmUoeyB2YWx1ZTogdiwgZG9uZTogZCB9KTsgfSwgcmVqZWN0KTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19tYWtlVGVtcGxhdGVPYmplY3QoY29va2VkLCByYXcpIHtcclxuICAgIGlmIChPYmplY3QuZGVmaW5lUHJvcGVydHkpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KGNvb2tlZCwgXCJyYXdcIiwgeyB2YWx1ZTogcmF3IH0pOyB9IGVsc2UgeyBjb29rZWQucmF3ID0gcmF3OyB9XHJcbiAgICByZXR1cm4gY29va2VkO1xyXG59O1xyXG5cclxudmFyIF9fc2V0TW9kdWxlRGVmYXVsdCA9IE9iamVjdC5jcmVhdGUgPyAoZnVuY3Rpb24obywgdikge1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sIFwiZGVmYXVsdFwiLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2IH0pO1xyXG59KSA6IGZ1bmN0aW9uKG8sIHYpIHtcclxuICAgIG9bXCJkZWZhdWx0XCJdID0gdjtcclxufTtcclxuXHJcbnZhciBvd25LZXlzID0gZnVuY3Rpb24obykge1xyXG4gICAgb3duS2V5cyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzIHx8IGZ1bmN0aW9uIChvKSB7XHJcbiAgICAgICAgdmFyIGFyID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgayBpbiBvKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG8sIGspKSBhclthci5sZW5ndGhdID0gaztcclxuICAgICAgICByZXR1cm4gYXI7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIG93bktleXMobyk7XHJcbn07XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19pbXBvcnRTdGFyKG1vZCkge1xyXG4gICAgaWYgKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgcmV0dXJuIG1vZDtcclxuICAgIHZhciByZXN1bHQgPSB7fTtcclxuICAgIGlmIChtb2QgIT0gbnVsbCkgZm9yICh2YXIgayA9IG93bktleXMobW9kKSwgaSA9IDA7IGkgPCBrLmxlbmd0aDsgaSsrKSBpZiAoa1tpXSAhPT0gXCJkZWZhdWx0XCIpIF9fY3JlYXRlQmluZGluZyhyZXN1bHQsIG1vZCwga1tpXSk7XHJcbiAgICBfX3NldE1vZHVsZURlZmF1bHQocmVzdWx0LCBtb2QpO1xyXG4gICAgcmV0dXJuIHJlc3VsdDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9faW1wb3J0RGVmYXVsdChtb2QpIHtcclxuICAgIHJldHVybiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSA/IG1vZCA6IHsgZGVmYXVsdDogbW9kIH07XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2NsYXNzUHJpdmF0ZUZpZWxkR2V0KHJlY2VpdmVyLCBzdGF0ZSwga2luZCwgZikge1xyXG4gICAgaWYgKGtpbmQgPT09IFwiYVwiICYmICFmKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiUHJpdmF0ZSBhY2Nlc3NvciB3YXMgZGVmaW5lZCB3aXRob3V0IGEgZ2V0dGVyXCIpO1xyXG4gICAgaWYgKHR5cGVvZiBzdGF0ZSA9PT0gXCJmdW5jdGlvblwiID8gcmVjZWl2ZXIgIT09IHN0YXRlIHx8ICFmIDogIXN0YXRlLmhhcyhyZWNlaXZlcikpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgcmVhZCBwcml2YXRlIG1lbWJlciBmcm9tIGFuIG9iamVjdCB3aG9zZSBjbGFzcyBkaWQgbm90IGRlY2xhcmUgaXRcIik7XHJcbiAgICByZXR1cm4ga2luZCA9PT0gXCJtXCIgPyBmIDoga2luZCA9PT0gXCJhXCIgPyBmLmNhbGwocmVjZWl2ZXIpIDogZiA/IGYudmFsdWUgOiBzdGF0ZS5nZXQocmVjZWl2ZXIpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19jbGFzc1ByaXZhdGVGaWVsZFNldChyZWNlaXZlciwgc3RhdGUsIHZhbHVlLCBraW5kLCBmKSB7XHJcbiAgICBpZiAoa2luZCA9PT0gXCJtXCIpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJQcml2YXRlIG1ldGhvZCBpcyBub3Qgd3JpdGFibGVcIik7XHJcbiAgICBpZiAoa2luZCA9PT0gXCJhXCIgJiYgIWYpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJQcml2YXRlIGFjY2Vzc29yIHdhcyBkZWZpbmVkIHdpdGhvdXQgYSBzZXR0ZXJcIik7XHJcbiAgICBpZiAodHlwZW9mIHN0YXRlID09PSBcImZ1bmN0aW9uXCIgPyByZWNlaXZlciAhPT0gc3RhdGUgfHwgIWYgOiAhc3RhdGUuaGFzKHJlY2VpdmVyKSkgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCB3cml0ZSBwcml2YXRlIG1lbWJlciB0byBhbiBvYmplY3Qgd2hvc2UgY2xhc3MgZGlkIG5vdCBkZWNsYXJlIGl0XCIpO1xyXG4gICAgcmV0dXJuIChraW5kID09PSBcImFcIiA/IGYuY2FsbChyZWNlaXZlciwgdmFsdWUpIDogZiA/IGYudmFsdWUgPSB2YWx1ZSA6IHN0YXRlLnNldChyZWNlaXZlciwgdmFsdWUpKSwgdmFsdWU7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2NsYXNzUHJpdmF0ZUZpZWxkSW4oc3RhdGUsIHJlY2VpdmVyKSB7XHJcbiAgICBpZiAocmVjZWl2ZXIgPT09IG51bGwgfHwgKHR5cGVvZiByZWNlaXZlciAhPT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgcmVjZWl2ZXIgIT09IFwiZnVuY3Rpb25cIikpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgdXNlICdpbicgb3BlcmF0b3Igb24gbm9uLW9iamVjdFwiKTtcclxuICAgIHJldHVybiB0eXBlb2Ygc3RhdGUgPT09IFwiZnVuY3Rpb25cIiA/IHJlY2VpdmVyID09PSBzdGF0ZSA6IHN0YXRlLmhhcyhyZWNlaXZlcik7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FkZERpc3Bvc2FibGVSZXNvdXJjZShlbnYsIHZhbHVlLCBhc3luYykge1xyXG4gICAgaWYgKHZhbHVlICE9PSBudWxsICYmIHZhbHVlICE9PSB2b2lkIDApIHtcclxuICAgICAgICBpZiAodHlwZW9mIHZhbHVlICE9PSBcIm9iamVjdFwiICYmIHR5cGVvZiB2YWx1ZSAhPT0gXCJmdW5jdGlvblwiKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiT2JqZWN0IGV4cGVjdGVkLlwiKTtcclxuICAgICAgICB2YXIgZGlzcG9zZSwgaW5uZXI7XHJcbiAgICAgICAgaWYgKGFzeW5jKSB7XHJcbiAgICAgICAgICAgIGlmICghU3ltYm9sLmFzeW5jRGlzcG9zZSkgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN5bWJvbC5hc3luY0Rpc3Bvc2UgaXMgbm90IGRlZmluZWQuXCIpO1xyXG4gICAgICAgICAgICBkaXNwb3NlID0gdmFsdWVbU3ltYm9sLmFzeW5jRGlzcG9zZV07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChkaXNwb3NlID09PSB2b2lkIDApIHtcclxuICAgICAgICAgICAgaWYgKCFTeW1ib2wuZGlzcG9zZSkgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN5bWJvbC5kaXNwb3NlIGlzIG5vdCBkZWZpbmVkLlwiKTtcclxuICAgICAgICAgICAgZGlzcG9zZSA9IHZhbHVlW1N5bWJvbC5kaXNwb3NlXTtcclxuICAgICAgICAgICAgaWYgKGFzeW5jKSBpbm5lciA9IGRpc3Bvc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0eXBlb2YgZGlzcG9zZSAhPT0gXCJmdW5jdGlvblwiKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiT2JqZWN0IG5vdCBkaXNwb3NhYmxlLlwiKTtcclxuICAgICAgICBpZiAoaW5uZXIpIGRpc3Bvc2UgPSBmdW5jdGlvbigpIHsgdHJ5IHsgaW5uZXIuY2FsbCh0aGlzKTsgfSBjYXRjaCAoZSkgeyByZXR1cm4gUHJvbWlzZS5yZWplY3QoZSk7IH0gfTtcclxuICAgICAgICBlbnYuc3RhY2sucHVzaCh7IHZhbHVlOiB2YWx1ZSwgZGlzcG9zZTogZGlzcG9zZSwgYXN5bmM6IGFzeW5jIH0pO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoYXN5bmMpIHtcclxuICAgICAgICBlbnYuc3RhY2sucHVzaCh7IGFzeW5jOiB0cnVlIH0pO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHZhbHVlO1xyXG5cclxufVxyXG5cclxudmFyIF9TdXBwcmVzc2VkRXJyb3IgPSB0eXBlb2YgU3VwcHJlc3NlZEVycm9yID09PSBcImZ1bmN0aW9uXCIgPyBTdXBwcmVzc2VkRXJyb3IgOiBmdW5jdGlvbiAoZXJyb3IsIHN1cHByZXNzZWQsIG1lc3NhZ2UpIHtcclxuICAgIHZhciBlID0gbmV3IEVycm9yKG1lc3NhZ2UpO1xyXG4gICAgcmV0dXJuIGUubmFtZSA9IFwiU3VwcHJlc3NlZEVycm9yXCIsIGUuZXJyb3IgPSBlcnJvciwgZS5zdXBwcmVzc2VkID0gc3VwcHJlc3NlZCwgZTtcclxufTtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2Rpc3Bvc2VSZXNvdXJjZXMoZW52KSB7XHJcbiAgICBmdW5jdGlvbiBmYWlsKGUpIHtcclxuICAgICAgICBlbnYuZXJyb3IgPSBlbnYuaGFzRXJyb3IgPyBuZXcgX1N1cHByZXNzZWRFcnJvcihlLCBlbnYuZXJyb3IsIFwiQW4gZXJyb3Igd2FzIHN1cHByZXNzZWQgZHVyaW5nIGRpc3Bvc2FsLlwiKSA6IGU7XHJcbiAgICAgICAgZW52Lmhhc0Vycm9yID0gdHJ1ZTtcclxuICAgIH1cclxuICAgIHZhciByLCBzID0gMDtcclxuICAgIGZ1bmN0aW9uIG5leHQoKSB7XHJcbiAgICAgICAgd2hpbGUgKHIgPSBlbnYuc3RhY2sucG9wKCkpIHtcclxuICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgIGlmICghci5hc3luYyAmJiBzID09PSAxKSByZXR1cm4gcyA9IDAsIGVudi5zdGFjay5wdXNoKHIpLCBQcm9taXNlLnJlc29sdmUoKS50aGVuKG5leHQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHIuZGlzcG9zZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSByLmRpc3Bvc2UuY2FsbChyLnZhbHVlKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoci5hc3luYykgcmV0dXJuIHMgfD0gMiwgUHJvbWlzZS5yZXNvbHZlKHJlc3VsdCkudGhlbihuZXh0LCBmdW5jdGlvbihlKSB7IGZhaWwoZSk7IHJldHVybiBuZXh0KCk7IH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSBzIHw9IDE7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgICAgIGZhaWwoZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHMgPT09IDEpIHJldHVybiBlbnYuaGFzRXJyb3IgPyBQcm9taXNlLnJlamVjdChlbnYuZXJyb3IpIDogUHJvbWlzZS5yZXNvbHZlKCk7XHJcbiAgICAgICAgaWYgKGVudi5oYXNFcnJvcikgdGhyb3cgZW52LmVycm9yO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIG5leHQoKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fcmV3cml0ZVJlbGF0aXZlSW1wb3J0RXh0ZW5zaW9uKHBhdGgsIHByZXNlcnZlSnN4KSB7XHJcbiAgICBpZiAodHlwZW9mIHBhdGggPT09IFwic3RyaW5nXCIgJiYgL15cXC5cXC4/XFwvLy50ZXN0KHBhdGgpKSB7XHJcbiAgICAgICAgcmV0dXJuIHBhdGgucmVwbGFjZSgvXFwuKHRzeCkkfCgoPzpcXC5kKT8pKCg/OlxcLlteLi9dKz8pPylcXC4oW2NtXT8pdHMkL2ksIGZ1bmN0aW9uIChtLCB0c3gsIGQsIGV4dCwgY20pIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRzeCA/IHByZXNlcnZlSnN4ID8gXCIuanN4XCIgOiBcIi5qc1wiIDogZCAmJiAoIWV4dCB8fCAhY20pID8gbSA6IChkICsgZXh0ICsgXCIuXCIgKyBjbS50b0xvd2VyQ2FzZSgpICsgXCJqc1wiKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIHJldHVybiBwYXRoO1xyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCB7XHJcbiAgICBfX2V4dGVuZHM6IF9fZXh0ZW5kcyxcclxuICAgIF9fYXNzaWduOiBfX2Fzc2lnbixcclxuICAgIF9fcmVzdDogX19yZXN0LFxyXG4gICAgX19kZWNvcmF0ZTogX19kZWNvcmF0ZSxcclxuICAgIF9fcGFyYW06IF9fcGFyYW0sXHJcbiAgICBfX2VzRGVjb3JhdGU6IF9fZXNEZWNvcmF0ZSxcclxuICAgIF9fcnVuSW5pdGlhbGl6ZXJzOiBfX3J1bkluaXRpYWxpemVycyxcclxuICAgIF9fcHJvcEtleTogX19wcm9wS2V5LFxyXG4gICAgX19zZXRGdW5jdGlvbk5hbWU6IF9fc2V0RnVuY3Rpb25OYW1lLFxyXG4gICAgX19tZXRhZGF0YTogX19tZXRhZGF0YSxcclxuICAgIF9fYXdhaXRlcjogX19hd2FpdGVyLFxyXG4gICAgX19nZW5lcmF0b3I6IF9fZ2VuZXJhdG9yLFxyXG4gICAgX19jcmVhdGVCaW5kaW5nOiBfX2NyZWF0ZUJpbmRpbmcsXHJcbiAgICBfX2V4cG9ydFN0YXI6IF9fZXhwb3J0U3RhcixcclxuICAgIF9fdmFsdWVzOiBfX3ZhbHVlcyxcclxuICAgIF9fcmVhZDogX19yZWFkLFxyXG4gICAgX19zcHJlYWQ6IF9fc3ByZWFkLFxyXG4gICAgX19zcHJlYWRBcnJheXM6IF9fc3ByZWFkQXJyYXlzLFxyXG4gICAgX19zcHJlYWRBcnJheTogX19zcHJlYWRBcnJheSxcclxuICAgIF9fYXdhaXQ6IF9fYXdhaXQsXHJcbiAgICBfX2FzeW5jR2VuZXJhdG9yOiBfX2FzeW5jR2VuZXJhdG9yLFxyXG4gICAgX19hc3luY0RlbGVnYXRvcjogX19hc3luY0RlbGVnYXRvcixcclxuICAgIF9fYXN5bmNWYWx1ZXM6IF9fYXN5bmNWYWx1ZXMsXHJcbiAgICBfX21ha2VUZW1wbGF0ZU9iamVjdDogX19tYWtlVGVtcGxhdGVPYmplY3QsXHJcbiAgICBfX2ltcG9ydFN0YXI6IF9faW1wb3J0U3RhcixcclxuICAgIF9faW1wb3J0RGVmYXVsdDogX19pbXBvcnREZWZhdWx0LFxyXG4gICAgX19jbGFzc1ByaXZhdGVGaWVsZEdldDogX19jbGFzc1ByaXZhdGVGaWVsZEdldCxcclxuICAgIF9fY2xhc3NQcml2YXRlRmllbGRTZXQ6IF9fY2xhc3NQcml2YXRlRmllbGRTZXQsXHJcbiAgICBfX2NsYXNzUHJpdmF0ZUZpZWxkSW46IF9fY2xhc3NQcml2YXRlRmllbGRJbixcclxuICAgIF9fYWRkRGlzcG9zYWJsZVJlc291cmNlOiBfX2FkZERpc3Bvc2FibGVSZXNvdXJjZSxcclxuICAgIF9fZGlzcG9zZVJlc291cmNlczogX19kaXNwb3NlUmVzb3VyY2VzLFxyXG4gICAgX19yZXdyaXRlUmVsYXRpdmVJbXBvcnRFeHRlbnNpb246IF9fcmV3cml0ZVJlbGF0aXZlSW1wb3J0RXh0ZW5zaW9uLFxyXG59O1xyXG4iLCJleHBvcnQgZGVmYXVsdCB7XHJcbiAgICAvKiBTZWN0aW9uIGhlYWRlcnMgKi9cclxuXHJcbiAgICBQTFVHSU5fU0VUVElOR1NfSEVBREVSOiBcIlJlZ2V4IFF1aWNrIEFjdGlvbnMgc2V0dGluZ3NcIixcclxuICAgIE1BTkFHRV9TRUNUSU9OX0hFQURFUjogXCJNYW5hZ2UgcXVpY2sgYWN0aW9uc1wiLFxyXG4gICAgR0VORVJBTF9TRUNUSU9OX0hFQURFUjogXCJHZW5lcmFsXCIsXHJcbiAgICBQTFVHSU5fREVTQzogXCJUaGlzIHBsdWdpbiBhbGxvd3MgeW91IHRvIGNyZWF0ZSBhbmQgcXVpY2tseSBhcHBseSByZWdleCBhY3Rpb25zIHZpYTogdGhlIGNvbW1hbmQgcGFsZXR0ZSwgdGhlIGZpbGUgY29udGV4dCBtZW51IGluIHRoZSBleHBsb3JlciwgdGhlIGZvbGRlciBjb250ZXh0IG1lbnUgaW4gdGhlIGV4cGxvcmVyLCB0aGUgaG90a2V5cy4gRXZlcnkgc2F2ZWQgYWN0aW9uIGJlY29tZXMgYSBwYWxldHRlIGNvbW1hbmQsIHdoaWNoIGVuc3VyZXMgYXV0b21hdGlzYXRpb24gcG9zc2liaWxpdGllcy5cIixcclxuICAgIFxyXG4gICAgLyogR2VuZXJpYyBidXR0b25zICovXHJcbiAgICBcclxuICAgIEFERDogXCJBZGRcIixcclxuICAgIFNBVkU6IFwiU2F2ZVwiLFxyXG4gICAgQ0FOQ0VMOiBcIkNhbmNlbFwiLFxyXG4gICAgWUVTOiBcIlllc1wiLFxyXG4gICAgRURJVDogXCJFZGl0XCIsXHJcbiAgICBERUxFVEU6IFwiRGVsZXRlXCIsXHJcbiAgICBcclxuICAgIC8qIERpYWxvZyB0ZXh0cyAqL1xyXG5cclxuICAgIERFTEVURV9IRUFERVI6IFwiRGVsZXRlIHF1aWNrIGFjdGlvblwiLFxyXG4gICAgREVMRVRFX0NPTkZJUk06IFwiQXJlIHlvdSBzdXJlIHlvdSB3YW50IHRvIGRlbGV0ZSBxdWljayBhY3Rpb24gXFxcInt9XFxcIj9cIixcclxuICAgIEZPTERFUl9BQ1RJT05fQ09ORklSTV9USVRMRTogXCJSdW4gcXVpY2sgYWN0aW9uIG9uIGZvbGRlclwiLFxyXG4gICAgRk9MREVSX0FDVElPTl9DT05GSVJNX01TRzogXCJBcmUgeW91IHN1cmUgdGhhdCB5b3Ugd2FudCB0byBydW4gZGVmYXVsdCBxdWljayBhY3Rpb24gb24gZXZlcnkgZmlsZSBpbnNpZGUgdGhpcyBmb2xkZXI/IFRoaXMgYWN0aW9uIGlzIGlycmV2ZXJzaWJsZS5cIixcclxuXHJcbiAgICAvKiBEZXNjcmlwdGlvbnMgKi9cclxuXHJcbiAgICBQTEFDRUhPTERFUl9OQU1FOiBcIlVzZWQgdG8gY2FsbCBxdWljayBhY3Rpb25zIHZpYSBjb21tYW5kIHBhbGV0dGVcIixcclxuICAgIFBMQUNFSE9MREVSX1NFQVJDSDogXCJTZWFyY2ggcGF0dGVyblwiLFxyXG4gICAgUExBQ0VIT0xERVJfRkxBR1M6IFwiZS5nLiBnbVwiLFxyXG4gICAgUExBQ0VIT0xERVJfUkVQTEFDRU1FTlQ6IFwiUmVwbGFjZW1lbnQgdGV4dFwiLFxyXG4gICAgQUREX1FVSUNLX0FDVElPTjogXCJOZXcgcXVpY2sgYWN0aW9uXCIsXHJcbiAgICBBQ1RJT05fTkFNRTogXCJRdWljayBhY3Rpb24gbmFtZVwiLFxyXG4gICAgU0VBUkNIX1JFR0VYOiBcIlJlZ2V4IHJ1bGVcIixcclxuICAgIEZMQUdTOiBcIkZsYWdzXCIsXHJcbiAgICBSRVBMQUNFTUVOVDogXCJSZXBsYWNlbWVudFwiLFxyXG4gICAgU0VUX0FTX0RFRkFVTFQ6IFwiU2V0IGFzIGRlZmF1bHQgcXVpY2sgYWN0aW9uXCIsXHJcbiAgICBSVU5fREVGQVVMVDogXCJSdW4gZGVmYXVsdCBxdWljayBhY3Rpb25cIixcclxuICAgIFJVTl9ERUZBVUxUX09OX0ZPTERFUjogXCJSdW4gZGVmYXVsdCBxdWljayBhY3Rpb24gb24gZm9sZGVyXCIsXHJcbiAgICBDT05GSVJNX0ZPTERFUl9BQ1RJT046IFwiQ29uZmlybWF0aW9uIGZvciBxdWljayBhY3Rpb24gb24gZm9sZGVyXCIsXHJcbiAgICBDT05GSVJNX0ZPTERFUl9BQ1RJT05fREVTQzogXCJTaG93IGEgY29uZmlybWF0aW9uIGRpYWxvZyBiZWZvcmUgcnVubmluZyBxdWljayBhY3Rpb24gb24gZXZlcnkgZmlsZSBpbnNpZGUgYSBjaG9zZW4gZm9sZGVyLlwiLFxyXG5cclxuICAgIC8qIEVycm9ycyBhbmQgbWVzc2FnZXMgKi9cclxuXHJcbiAgICBOQU1FX0VNUFRZX0VSUjogXCJFcnJvcjogUXVpY2sgYWN0aW9uIG5hbWUgY2Fubm90IGJlIGVtcHR5IVwiLFxyXG4gICAgTkFNRV9FWElTVFNfRVJSOiBcIkVycm9yOiBBbiBhY3Rpb24gd2l0aCB0aGlzIG5hbWUgYWxyZWFkeSBleGlzdHMhXCIsXHJcbiAgICBQQVRURVJOX0VNUFRZX0VSUjogXCJFcnJvcjogUmVnZXggcGF0dGVybiBjYW5ub3QgYmUgZW1wdHkhXCIsXHJcbiAgICBGTEFHU19JTlZBTElEX0VSUjogXCJFcnJvcjogSW52YWxpZCByZWdleCBmbGFncyBwcm92aWRlZCFcIixcclxuICAgIFJFR0VYX0lOVkFMSURfRVJSOiBcIkVycm9yOiBJbnZhbGlkIHJlZ3VsYXIgZXhwcmVzc2lvbiBzeW50YXghXCIsXHJcbiAgICBOT1RfRk9VTkRfRVJSOiBcIiBub3QgZm91bmQhXCIsXHJcbiAgICBFWEVDVVRFRF9NU0c6IFwiRXhlY3V0ZWQgJ3t9JyB3aXRoIHt9IHJlcGxhY2VtZW50cy5cIlxyXG59OyIsImV4cG9ydCBkZWZhdWx0IHtcclxuICAgIC8qIFNlY3Rpb24gaGVhZGVycyAqL1xyXG5cclxuICAgIFBMVUdJTl9TRVRUSU5HU19IRUFERVI6IFwi0J3QsNGB0YLRgNC+0LnQutC4IFJlZ2V4IFF1aWNrIEFjdGlvbnNcIixcclxuICAgIE1BTkFHRV9TRUNUSU9OX0hFQURFUjogXCLQo9C/0YDQsNCy0LvQtdC90LjQtSDQsdGL0YHRgtGA0YvQvNC4INC60L7QvNCw0L3QtNCw0LzQuFwiLFxyXG4gICAgR0VORVJBTF9TRUNUSU9OX0hFQURFUjogXCLQntGB0L3QvtCy0L3Ri9C1XCIsXHJcbiAgICBQTFVHSU5fREVTQzogXCLQlNCw0L3QvdGL0Lkg0L/Qu9Cw0LPQuNC9INC/0L7Qt9Cy0L7Qu9GP0LXRgiDRgdC+0LfQtNCw0LLQsNGC0Ywg0Lgg0LHRi9GB0YLRgNC+INC/0YDQuNC80LXQvdGP0YLRjCDQutC+0LzQsNC90LTRiyByZWdleCDRh9C10YDQtdC3OiDQv9Cw0LvQuNGC0YDRgyDQutC+0LzQsNC90LQsINC60L7QvdGC0LXQutGB0YLQvdC+0LUg0LzQtdC90Y4g0YTQsNC50LvQsCDQsiDQv9GA0L7QstC+0LTQvdC40LrQtSwg0LrQvtC90YLQtdC60YHRgtC90L7QtSDQvNC10L3RjiDQv9Cw0L/QutC4INCyINC/0YDQvtCy0L7QtNC90LjQutC1LCDQutC+0L3RgtC10LrRgdGC0L3QvtC1INC80LXQvdGOINCw0LrRgtC40LLQvdC+0Lkg0LfQsNC80LXRgtC60LgsINGB0L7QutGA0LDRidC10L3QuNGPINC60LvQsNCy0LjRiC4g0JrQsNC20LTQsNGPINGB0L7RhdGA0LDQvdGR0L3QvdCw0Y8g0LrQvtC80LDQvdC00LAg0L/QvtGP0LLQu9GP0LXRgtGB0Y8g0LIg0L/QsNC70LjRgtGA0LUg0LrQvtC80LDQvdC0LCDRh9GC0L4g0L/QvtC30LLQvtC70Y/QtdGCINC40YHQv9C+0LvRjNC30L7QstCw0YLRjCDQv9C70LDQs9C40L0g0LTQu9GPINCw0LLRgtC+0LzQsNGC0LjQt9Cw0YbQuNC4LlwiLFxyXG4gICAgXHJcbiAgICAvKiBHZW5lcmljIGJ1dHRvbnMgKi9cclxuICAgIFxyXG4gICAgQUREOiBcItCU0L7QsdCw0LLQuNGC0YxcIixcclxuICAgIFNBVkU6IFwi0KHQvtGF0YDQsNC90LjRgtGMXCIsXHJcbiAgICBDQU5DRUw6IFwi0J7RgtC80LXQvdC40YLRjFwiLFxyXG4gICAgWUVTOiBcItCU0LBcIixcclxuICAgIEVESVQ6IFwi0KDQtdC00LDQutGC0LjRgNC+0LLQsNGC0YxcIixcclxuICAgIERFTEVURTogXCLQo9C00LDQu9C40YLRjFwiLFxyXG4gICAgXHJcbiAgICAvKiBEaWFsb2cgdGV4dHMgKi9cclxuXHJcbiAgICBERUxFVEVfSEVBREVSOiBcItCj0LTQsNC70LjRgtGMINCx0YvRgdGC0YDRg9GOINC60L7QvNCw0L3QtNGDXCIsXHJcbiAgICBERUxFVEVfQ09ORklSTTogXCLQktGLINGD0LLQtdGA0LXQvdGLLCDRh9GC0L4g0YXQvtGC0LjRgtC1INGD0LTQsNC70LjRgtGMINCx0YvRgdGC0YDRg9GOINC60L7QvNCw0L3QtNGDIFxcXCJ7fVxcXCI/XCIsXHJcbiAgICBGT0xERVJfQUNUSU9OX0NPTkZJUk1fVElUTEU6IFwi0J/RgNC40LzQtdC90LjRgtGMINCx0YvRgdGC0YDRg9GOINC60L7QvNCw0L3QtNGDINC6INC/0LDQv9C60LVcIixcclxuICAgIEZPTERFUl9BQ1RJT05fQ09ORklSTV9NU0c6IFwi0JLRiyDRg9Cy0LXRgNC10L3Riywg0YfRgtC+INGF0L7RgtC40YLQtSDQv9GA0LjQvNC10L3QuNGC0Ywg0LHRi9GB0YLRgNGD0Y4g0LrQvtC80LDQvdC00YMg0L/QviDRg9C80L7Qu9GH0LDQvdC40Y4g0Log0LrQsNC20LTQvtC80YMg0YTQsNC50LvRgyDQstC90YPRgtGA0Lgg0Y3RgtC+0Lkg0L/QsNC/0LrQuD8g0K3RgtC+INC00LXQudGB0YLQstC40LUg0L3QtdC70YzQt9GPINC+0YLQvNC10L3QuNGC0YwuXCIsXHJcblxyXG4gICAgLyogRGVzY3JpcHRpb25zICovXHJcblxyXG4gICAgUExBQ0VIT0xERVJfTkFNRTogXCLQmNGB0L/QvtC70YzQt9GD0LXRgtGB0Y8g0LTQu9GPINCy0YvQt9C+0LLQsCDQsdGL0YHRgtGA0L7QuSDQutC+0LzQsNC90LTRiyDRh9C10YDQtdC3INC/0LDQu9C40YLRgNGDINC60L7QvNCw0L3QtFwiLFxyXG4gICAgUExBQ0VIT0xERVJfU0VBUkNIOiBcItCf0LDRgtGC0LXRgNC9INC00LvRjyDQv9C+0LjRgdC60LBcIixcclxuICAgIFBMQUNFSE9MREVSX0ZMQUdTOiBcItC90LDQv9GALiBnbVwiLFxyXG4gICAgUExBQ0VIT0xERVJfUkVQTEFDRU1FTlQ6IFwi0J/QsNGC0YLQtdGA0L0g0LTQu9GPINC30LDQvNC10L3Ri1wiLFxyXG4gICAgQUREX1FVSUNLX0FDVElPTjogXCLQndC+0LLQsNGPINCx0YvRgdGC0YDQsNGPINC60L7QvNCw0L3QtNCwXCIsXHJcbiAgICBBQ1RJT05fTkFNRTogXCLQndCw0LfQstCw0L3QuNC1INCx0YvRgdGC0YDQvtC5INC60L7QvNCw0L3QtNGLXCIsXHJcbiAgICBTRUFSQ0hfUkVHRVg6IFwi0J/RgNCw0LLQuNC70L4gcmVnZXhcIixcclxuICAgIEZMQUdTOiBcItCk0LvQsNCz0LhcIixcclxuICAgIFJFUExBQ0VNRU5UOiBcItCX0LDQvNC10L3QsFwiLFxyXG4gICAgU0VUX0FTX0RFRkFVTFQ6IFwi0KPRgdGC0LDQvdC+0LLQuNGC0Ywg0LrQsNC6INCx0YvRgdGC0YDRg9GOINC60L7QvNCw0L3QtNGDINC/0L4g0YPQvNC+0LvRh9Cw0L3QuNGOXCIsXHJcbiAgICBSVU5fREVGQVVMVDogXCLQn9GA0LjQvNC10L3QuNGC0Ywg0LHRi9GB0YLRgNGD0Y4g0LrQvtC80LDQvdC00YMg0L/QviDRg9C80L7Qu9GH0LDQvdC40Y5cIixcclxuICAgIFJVTl9ERUZBVUxUX09OX0ZPTERFUjogXCLQn9GA0LjQvNC10L3QuNGC0Ywg0LHRi9GB0YLRgNGD0Y4g0LrQvtC80LDQvdC00YMg0L/QviDRg9C80L7Qu9GH0LDQvdC40Y4g0Log0L/QsNC/0LrQtVwiLFxyXG4gICAgQ09ORklSTV9GT0xERVJfQUNUSU9OOiBcItCf0L7QtNGC0LLQtdGA0LbQtNC10L3QuNC1INC/0LXRgNC10LQg0L/RgNC40LzQtdC90LXQvdC40LXQvCDQsdGL0YHRgtGA0L7QuSDQutC+0LzQsNC90LTRiyDQuiDQv9Cw0L/QutC1XCIsXHJcbiAgICBDT05GSVJNX0ZPTERFUl9BQ1RJT05fREVTQzogXCLQn9C+0LrQsNC30YvQstCw0YLRjCDQtNC40LDQu9C+0LMg0L/QvtC00YLQstC10YDQttC00LXQvdC40Y8g0L/QtdGA0LXQtCDQv9GA0LjQvNC10L3QtdC90LjQtdC8INCx0YvRgdGC0YDQvtC5INC60L7QvNCw0L3QtNGLINC6INC60LDQttC00L7QvNGDINGE0LDQudC70YMg0LIg0LLRi9Cx0YDQsNC90L3QvtC5INC/0LDQv9C60LUuXCIsXHJcblxyXG4gICAgLyogRXJyb3JzIGFuZCBtZXNzYWdlcyAqL1xyXG5cclxuICAgIE5BTUVfRU1QVFlfRVJSOiBcItCe0YjQuNCx0LrQsDog0JjQvNGPINCx0YvRgdGC0YDQvtC5INC60L7QvNCw0L3QtNGLINC90LUg0LzQvtC20LXRgiDQsdGL0YLRjCDQv9GD0YHRgtGL0LwhXCIsXHJcbiAgICBOQU1FX0VYSVNUU19FUlI6IFwi0J7RiNC40LHQutCwOiDQmtC+0LzQsNC90LTQsCDRgSDRgtCw0LrQuNC8INC20LUg0LjQvNC10L3QtdC8INGD0LbQtSDRgdGD0YnQtdGB0YLQstGD0LXRgiFcIixcclxuICAgIFBBVFRFUk5fRU1QVFlfRVJSOiBcItCe0YjQuNCx0LrQsDog0J/QsNGC0YLQtdGA0L0gcmVnZXgg0L3QtSDQvNC+0LbQtdGCINCx0YvRgtGMINC/0YPRgdGC0YvQvCFcIixcclxuICAgIEZMQUdTX0lOVkFMSURfRVJSOiBcItCe0YjQuNCx0LrQsDog0KPQutCw0LfQsNC90Ysg0L3QtdC60L7RgNGA0LXQutGC0L3Ri9C1INGE0LvQsNCz0LggcmVnZXghXCIsXHJcbiAgICBSRUdFWF9JTlZBTElEX0VSUjogXCLQntGI0LjQsdC60LA6INCd0LXQutC+0YDRgNC10LrRgtC90YvQuSDRgdC40L3RgtCw0LrRgdC40YEg0YDQtdCz0YPQu9GP0YDQvdC+0LPQviDQstGL0YDQsNC20LXQvdC40Y8hXCIsXHJcbiAgICBOT1RfRk9VTkRfRVJSOiBcIiDQvdC1INC90LDQudC00LXQvdC+IVwiLFxyXG4gICAgRVhFQ1VURURfTVNHOiBcItCa0L7QvNCw0L3QtNCwICd7fScg0L/RgNC40LzQtdC90LXQvdCwINGBIHt9INC30LDQvNC10L3QsNC80LguXCJcclxufTsiLCJpbXBvcnQgeyBtb21lbnQgfSBmcm9tICdvYnNpZGlhbic7XHJcbmltcG9ydCBlbiBmcm9tICcuL2xvY2FsZXMvZW4nO1xyXG5pbXBvcnQgcnUgZnJvbSAnLi9sb2NhbGVzL3J1JztcclxuXHJcbi8vIERlZmluZSBhIHR5cGUgYmFzZWQgb24gdGhlIHN0cnVjdHVyZSBvZiB5b3VyIGRlZmF1bHQgbGFuZ3VhZ2UgZmlsZVxyXG50eXBlIExvY2FsZU1lc3NhZ2VzID0gdHlwZW9mIGVuO1xyXG5cclxuY29uc3QgTUVTU0FHRVM6IFJlY29yZDxzdHJpbmcsIExvY2FsZU1lc3NhZ2VzPiA9IHtcclxuICAgIGVuOiBlbixcclxuICAgIHJ1OiBydSxcclxufTtcclxuXHJcbmNvbnN0IGxvY2FsZSA9IG1vbWVudC5sb2NhbGUoKTtcclxuXHJcbi8qKlxyXG4gKiBUcmFuc2xhdGVzIGEga2V5IGludG8gdGhlIGN1cnJlbnQgbG9jYWxlIHN0cmluZy5cclxuICogQHBhcmFtIGtleSAtIEEgdmFsaWQga2V5IGZyb20gdGhlIGxvY2FsZSBmaWxlc1xyXG4gKiBAcGFyYW0gYXJncyAtIFZhbHVlcyB0byByZXBsYWNlICd7fScgcGxhY2Vob2xkZXJzIGluIHRoZSBzdHJpbmdcclxuICovXHJcbmV4cG9ydCBjb25zdCB0ID0gKGtleToga2V5b2YgTG9jYWxlTWVzc2FnZXMsIC4uLmFyZ3M6IChzdHJpbmcgfCBudW1iZXIpW10pOiBzdHJpbmcgPT4ge1xyXG4gICAgLy8gQ2hlY2sgaWYgdGhlIGN1cnJlbnQgbG9jYWxlIGV4aXN0cyBpbiBvdXIgTUVTU0FHRVMsIG90aGVyd2lzZSBmYWxsYmFjayB0byBFbmdsaXNoXHJcbiAgICBjb25zdCBsYW5nID0gTUVTU0FHRVNbbG9jYWxlXSA/IGxvY2FsZSA6ICdlbic7XHJcbiAgICBsZXQgdGV4dDogc3RyaW5nID0gTUVTU0FHRVNbbGFuZ11ba2V5XSB8fCBNRVNTQUdFU1snZW4nXVtrZXldO1xyXG4gICAgXHJcbiAgICBhcmdzLmZvckVhY2goYXJnID0+IHtcclxuICAgICAgICB0ZXh0ID0gdGV4dC5yZXBsYWNlKCd7fScsIFN0cmluZyhhcmcpKTtcclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICByZXR1cm4gdGV4dDtcclxufTsiLCJpbXBvcnQgeyBBcHAsIEJ1dHRvbkNvbXBvbmVudCwgTWFya2Rvd25WaWV3LCBNb2RhbCwgTm90aWNlLCBQbHVnaW4sIFBsdWdpblNldHRpbmdUYWIsIFNldHRpbmcsIE1lbnUsIFRGaWxlLCBURm9sZGVyLCBUQWJzdHJhY3RGaWxlLCBUb2dnbGVDb21wb25lbnQgfSBmcm9tICdvYnNpZGlhbic7XHJcbmltcG9ydCB7IHQgfSBmcm9tICcuL2kxOG4nO1xyXG5cclxuLyoqXHJcbiAqIEludGVyZmFjZSB0byBhY2Nlc3MgaW50ZXJuYWwgT2JzaWRpYW4gY29tbWFuZCByZWdpc3RyeVxyXG4gKi9cclxuaW50ZXJmYWNlIENvbW1hbmRBcHAgZXh0ZW5kcyBBcHAge1xyXG4gICAgY29tbWFuZHM6IHtcclxuICAgICAgICByZW1vdmVDb21tYW5kKGlkOiBzdHJpbmcpOiB2b2lkO1xyXG4gICAgfTtcclxufVxyXG5cclxuaW50ZXJmYWNlIFJlZ2V4UXVpY2tBY3Rpb25zU2V0dGluZ3Mge1xyXG4gICAgcnVsZXM6IHN0cmluZ1tdO1xyXG4gICAgZGVmYXVsdFJ1bGU6IHN0cmluZyB8IG51bGw7XHJcbiAgICBjb25maXJtRm9sZGVyQWN0aW9uOiBib29sZWFuO1xyXG59XHJcblxyXG5jb25zdCBERUZBVUxUX1NFVFRJTkdTOiBSZWdleFF1aWNrQWN0aW9uc1NldHRpbmdzID0ge1xyXG4gICAgcnVsZXM6IFtdLFxyXG4gICAgZGVmYXVsdFJ1bGU6IG51bGwsXHJcbiAgICBjb25maXJtRm9sZGVyQWN0aW9uOiB0cnVlXHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFJlZ2V4UXVpY2tBY3Rpb25zIGV4dGVuZHMgUGx1Z2luIHtcclxuICAgIHNldHRpbmdzOiBSZWdleFF1aWNrQWN0aW9uc1NldHRpbmdzO1xyXG4gICAgcGF0aFRvUnVsZXNldHM6IHN0cmluZztcclxuXHJcbiAgICBhc3luYyBvbmxvYWQoKSB7XHJcbiAgICAgICAgYXdhaXQgdGhpcy5sb2FkU2V0dGluZ3MoKTtcclxuICAgICAgICB0aGlzLnBhdGhUb1J1bGVzZXRzID0gdGhpcy5hcHAudmF1bHQuY29uZmlnRGlyICsgXCIvcmVnZXgtcnVsZXNldHNcIjtcclxuICAgICAgICB0aGlzLmFkZFNldHRpbmdUYWIobmV3IFJlZ2V4UXVpY2tBY3Rpb25zU2V0dGluZ3NUYWIodGhpcy5hcHAsIHRoaXMpKTtcclxuXHJcbiAgICAgICAgdGhpcy5zZXR0aW5ncy5ydWxlcy5mb3JFYWNoKHJ1bGVOYW1lID0+IHtcclxuICAgICAgICAgICAgdGhpcy5hZGRSdWxlQ29tbWFuZChydWxlTmFtZSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHRoaXMucmVnaXN0ZXJFdmVudChcclxuICAgICAgICAgICAgdGhpcy5hcHAud29ya3NwYWNlLm9uKFwiZmlsZS1tZW51XCIsIChtZW51OiBNZW51LCBmaWxlOiBUQWJzdHJhY3RGaWxlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlICYmIHRoaXMuc2V0dGluZ3MuZGVmYXVsdFJ1bGUpIHtcclxuICAgICAgICAgICAgICAgICAgICBtZW51LmFkZEl0ZW0oKGl0ZW0pID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaXRlbVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnNldFRpdGxlKHQoJ1JVTl9ERUZBVUxUJykpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc2V0SWNvbihcInBsYXlcIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5vbkNsaWNrKGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmFwcGx5UnVsZXNldFRvRmlsZShmaWxlLCB0aGlzLnNldHRpbmdzLmRlZmF1bHRSdWxlISk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoZmlsZSBpbnN0YW5jZW9mIFRGb2xkZXIgJiYgdGhpcy5zZXR0aW5ncy5kZWZhdWx0UnVsZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIG1lbnUuYWRkSXRlbSgoaXRlbSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc2V0VGl0bGUodCgnUlVOX0RFRkFVTFRfT05fRk9MREVSJykpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc2V0SWNvbihcInBsYXlcIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBydW4gPSBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuYXBwbHlSdWxlc2V0VG9Gb2xkZXIoZmlsZSwgdGhpcy5zZXR0aW5ncy5kZWZhdWx0UnVsZSEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3MuY29uZmlybUZvbGRlckFjdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgQ29uZmlybWF0aW9uTW9kYWwoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFwcCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQoJ0ZPTERFUl9BQ1RJT05fQ09ORklSTV9USVRMRScpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdCgnRk9MREVSX0FDVElPTl9DT05GSVJNX01TRycpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdCgnWUVTJyksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBydW5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKS5vcGVuKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcnVuKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgKTtcclxuXHJcbiAgICAgICAgdGhpcy5yZWdpc3RlckV2ZW50KFxyXG4gICAgICAgICAgICB0aGlzLmFwcC53b3Jrc3BhY2Uub24oXCJlZGl0b3ItbWVudVwiLCAobWVudTogTWVudSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3MuZGVmYXVsdFJ1bGUpIHtcclxuICAgICAgICAgICAgICAgICAgICBtZW51LmFkZEl0ZW0oKGl0ZW0pID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaXRlbVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnNldFRpdGxlKHQoJ1JVTl9ERUZBVUxUJykpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc2V0SWNvbihcInBsYXlcIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5vbkNsaWNrKGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmFwcGx5UnVsZXNldCh0aGlzLnBhdGhUb1J1bGVzZXRzICsgXCIvXCIgKyB0aGlzLnNldHRpbmdzLmRlZmF1bHRSdWxlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICk7XHJcblxyXG4gICAgICAgIGF3YWl0IHRoaXMucmVsb2FkUnVsZXNldHMoKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGdldENvbW1hbmRJZChuYW1lOiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gICAgICAgIHJldHVybiBgYXBwbHktcnVsZS0ke25hbWUudG9Mb3dlckNhc2UoKS5yZXBsYWNlKC9bXmEtejAtOV0vZywgJy0nKX1gO1xyXG4gICAgfVxyXG5cclxuICAgIGFkZFJ1bGVDb21tYW5kKG5hbWU6IHN0cmluZykge1xyXG4gICAgICAgIHRoaXMuYWRkQ29tbWFuZCh7XHJcbiAgICAgICAgICAgIGlkOiB0aGlzLmdldENvbW1hbmRJZChuYW1lKSxcclxuICAgICAgICAgICAgbmFtZTogYCR7bmFtZX1gLFxyXG4gICAgICAgICAgICBjaGVja0NhbGxiYWNrOiAoY2hlY2tpbmc6IGJvb2xlYW4pID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGFjdGl2ZU1hcmtkb3duVmlldyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk7XHJcbiAgICAgICAgICAgICAgICBpZiAoYWN0aXZlTWFya2Rvd25WaWV3KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFjaGVja2luZykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFwcGx5UnVsZXNldCh0aGlzLnBhdGhUb1J1bGVzZXRzICsgXCIvXCIgKyBuYW1lKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBhc3luYyBsb2FkU2V0dGluZ3MoKSB7XHJcbiAgICAgICAgdGhpcy5zZXR0aW5ncyA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfU0VUVElOR1MsIGF3YWl0IHRoaXMubG9hZERhdGEoKSk7XHJcbiAgICB9XHJcblxyXG4gICAgYXN5bmMgc2F2ZVNldHRpbmdzKCkge1xyXG4gICAgICAgIGF3YWl0IHRoaXMuc2F2ZURhdGEodGhpcy5zZXR0aW5ncyk7XHJcbiAgICB9XHJcblxyXG4gICAgYXN5bmMgcmVsb2FkUnVsZXNldHMoKSB7XHJcbiAgICAgICAgaWYgKCFhd2FpdCB0aGlzLmFwcC52YXVsdC5hZGFwdGVyLmV4aXN0cyh0aGlzLnBhdGhUb1J1bGVzZXRzKSkge1xyXG4gICAgICAgICAgICBhd2FpdCB0aGlzLmFwcC52YXVsdC5jcmVhdGVGb2xkZXIodGhpcy5wYXRoVG9SdWxlc2V0cyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGFzeW5jIGNyZWF0ZVJ1bGVzZXQobmFtZTogc3RyaW5nLCBjb250ZW50OiBzdHJpbmcpOiBQcm9taXNlPGJvb2xlYW4+IHtcclxuICAgICAgICB0aGlzLnNldHRpbmdzLnJ1bGVzLnVuc2hpZnQobmFtZSk7XHJcbiAgICAgICAgY29uc3QgcGF0aCA9IHRoaXMucGF0aFRvUnVsZXNldHMgKyBcIi9cIiArIG5hbWU7XHJcbiAgICAgICAgYXdhaXQgdGhpcy5hcHAudmF1bHQuYWRhcHRlci53cml0ZShwYXRoLCBjb250ZW50KTtcclxuICAgICAgICBhd2FpdCB0aGlzLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgIHRoaXMuYWRkUnVsZUNvbW1hbmQobmFtZSk7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcblxyXG4gICAgYXN5bmMgdXBkYXRlUnVsZXNldChvbGROYW1lOiBzdHJpbmcsIG5ld05hbWU6IHN0cmluZywgY29udGVudDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgICAgICAgY29uc3Qgb2xkUGF0aCA9IHRoaXMucGF0aFRvUnVsZXNldHMgKyBcIi9cIiArIG9sZE5hbWU7XHJcbiAgICAgICAgY29uc3QgbmV3UGF0aCA9IHRoaXMucGF0aFRvUnVsZXNldHMgKyBcIi9cIiArIG5ld05hbWU7XHJcbiAgICAgICAgYXdhaXQgdGhpcy5hcHAudmF1bHQuYWRhcHRlci53cml0ZShuZXdQYXRoLCBjb250ZW50KTtcclxuICAgICAgICBpZiAob2xkTmFtZSAhPT0gbmV3TmFtZSkge1xyXG4gICAgICAgICAgICBpZiAoYXdhaXQgdGhpcy5hcHAudmF1bHQuYWRhcHRlci5leGlzdHMob2xkUGF0aCkpIHtcclxuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuYXBwLnZhdWx0LmFkYXB0ZXIucmVtb3ZlKG9sZFBhdGgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICh0aGlzLmFwcCBhcyBDb21tYW5kQXBwKS5jb21tYW5kcy5yZW1vdmVDb21tYW5kKGAke3RoaXMubWFuaWZlc3QuaWR9OiR7dGhpcy5nZXRDb21tYW5kSWQob2xkTmFtZSl9YCk7XHJcbiAgICAgICAgICAgIGNvbnN0IGluZGV4ID0gdGhpcy5zZXR0aW5ncy5ydWxlcy5pbmRleE9mKG9sZE5hbWUpO1xyXG4gICAgICAgICAgICBpZiAoaW5kZXggIT09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldHRpbmdzLnJ1bGVzW2luZGV4XSA9IG5ld05hbWU7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy5kZWZhdWx0UnVsZSA9PT0gb2xkTmFtZSkgdGhpcy5zZXR0aW5ncy5kZWZhdWx0UnVsZSA9IG5ld05hbWU7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hZGRSdWxlQ29tbWFuZChuZXdOYW1lKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBhc3luYyBkZWxldGVSdWxlc2V0KG5hbWU6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgICAgIGNvbnN0IHBhdGggPSB0aGlzLnBhdGhUb1J1bGVzZXRzICsgXCIvXCIgKyBuYW1lO1xyXG4gICAgICAgIGlmIChhd2FpdCB0aGlzLmFwcC52YXVsdC5hZGFwdGVyLmV4aXN0cyhwYXRoKSkge1xyXG4gICAgICAgICAgICBhd2FpdCB0aGlzLmFwcC52YXVsdC5hZGFwdGVyLnJlbW92ZShwYXRoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgKHRoaXMuYXBwIGFzIENvbW1hbmRBcHApLmNvbW1hbmRzLnJlbW92ZUNvbW1hbmQoYCR7dGhpcy5tYW5pZmVzdC5pZH06JHt0aGlzLmdldENvbW1hbmRJZChuYW1lKX1gKTtcclxuICAgICAgICB0aGlzLnNldHRpbmdzLnJ1bGVzID0gdGhpcy5zZXR0aW5ncy5ydWxlcy5maWx0ZXIociA9PiByICE9PSBuYW1lKTtcclxuICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy5kZWZhdWx0UnVsZSA9PT0gbmFtZSkgdGhpcy5zZXR0aW5ncy5kZWZhdWx0UnVsZSA9IG51bGw7XHJcbiAgICAgICAgYXdhaXQgdGhpcy5zYXZlU2V0dGluZ3MoKTtcclxuICAgIH1cclxuXHJcbiAgICBhc3luYyBhcHBseVJ1bGVzZXRUb0ZpbGUoZmlsZTogVEZpbGUsIHJ1bGVzZXROYW1lOiBzdHJpbmcpIHtcclxuICAgICAgICBjb25zdCBwYXRoID0gdGhpcy5wYXRoVG9SdWxlc2V0cyArIFwiL1wiICsgcnVsZXNldE5hbWU7XHJcbiAgICAgICAgaWYgKCFhd2FpdCB0aGlzLmFwcC52YXVsdC5hZGFwdGVyLmV4aXN0cyhwYXRoKSkgcmV0dXJuO1xyXG4gICAgICAgIGNvbnN0IHJ1bGVUZXh0ID0gYXdhaXQgdGhpcy5hcHAudmF1bHQuYWRhcHRlci5yZWFkKHBhdGgpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGNvbnN0IGNvdW50ID0gYXdhaXQgdGhpcy5tb2RpZnlGaWxlKGZpbGUsIHJ1bGVUZXh0LCBydWxlc2V0TmFtZSk7XHJcbiAgICAgICAgbmV3IE5vdGljZSh0KCdFWEVDVVRFRF9NU0cnLCBydWxlc2V0TmFtZSwgY291bnQpKTtcclxuICAgIH1cclxuXHJcbiAgICBhc3luYyBhcHBseVJ1bGVzZXRUb0ZvbGRlcihmb2xkZXI6IFRGb2xkZXIsIHJ1bGVzZXROYW1lOiBzdHJpbmcpIHtcclxuICAgICAgICBjb25zdCBwYXRoID0gdGhpcy5wYXRoVG9SdWxlc2V0cyArIFwiL1wiICsgcnVsZXNldE5hbWU7XHJcbiAgICAgICAgaWYgKCFhd2FpdCB0aGlzLmFwcC52YXVsdC5hZGFwdGVyLmV4aXN0cyhwYXRoKSkgcmV0dXJuO1xyXG4gICAgICAgIGNvbnN0IHJ1bGVUZXh0ID0gYXdhaXQgdGhpcy5hcHAudmF1bHQuYWRhcHRlci5yZWFkKHBhdGgpO1xyXG4gICAgICAgIGNvbnN0IGZpbGVzID0gdGhpcy5hcHAudmF1bHQuZ2V0TWFya2Rvd25GaWxlcygpLmZpbHRlcihmID0+IGYucGF0aC5zdGFydHNXaXRoKGZvbGRlci5wYXRoICsgXCIvXCIpKTtcclxuICAgICAgICBcclxuICAgICAgICBsZXQgdG90YWxDb3VudCA9IDA7XHJcbiAgICAgICAgZm9yIChjb25zdCBmaWxlIG9mIGZpbGVzKSB7XHJcbiAgICAgICAgICAgIHRvdGFsQ291bnQgKz0gYXdhaXQgdGhpcy5tb2RpZnlGaWxlKGZpbGUsIHJ1bGVUZXh0LCBydWxlc2V0TmFtZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIG5ldyBOb3RpY2UodCgnRVhFQ1VURURfTVNHJywgcnVsZXNldE5hbWUsIHRvdGFsQ291bnQpKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGFzeW5jIG1vZGlmeUZpbGUoZmlsZTogVEZpbGUsIHJ1bGVUZXh0OiBzdHJpbmcsIHJ1bGVzZXROYW1lOiBzdHJpbmcpOiBQcm9taXNlPG51bWJlcj4ge1xyXG4gICAgICAgIGNvbnN0IGFjdGl2ZVZpZXcgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGlmIChhY3RpdmVWaWV3ICYmIGFjdGl2ZVZpZXcuZmlsZT8ucGF0aCA9PT0gZmlsZS5wYXRoKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGVkaXRvciA9IGFjdGl2ZVZpZXcuZWRpdG9yO1xyXG4gICAgICAgICAgICBjb25zdCBzY3JvbGwgPSBlZGl0b3IuZ2V0U2Nyb2xsSW5mbygpO1xyXG4gICAgICAgICAgICBjb25zdCBjdXJzb3IgPSBlZGl0b3IuZ2V0Q3Vyc29yKCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSB0aGlzLnByb2Nlc3NSZWdleChlZGl0b3IuZ2V0VmFsdWUoKSwgcnVsZVRleHQsIHJ1bGVzZXROYW1lKTtcclxuICAgICAgICAgICAgZWRpdG9yLnNldFZhbHVlKHJlc3VsdC5jb250ZW50KTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGVkaXRvci5zZXRDdXJzb3IoY3Vyc29yKTtcclxuICAgICAgICAgICAgZWRpdG9yLnNjcm9sbFRvKDAsIHNjcm9sbC50b3ApO1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0LmNvdW50O1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGZpbGVDb250ZW50ID0gYXdhaXQgdGhpcy5hcHAudmF1bHQucmVhZChmaWxlKTtcclxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gdGhpcy5wcm9jZXNzUmVnZXgoZmlsZUNvbnRlbnQsIHJ1bGVUZXh0LCBydWxlc2V0TmFtZSk7XHJcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuYXBwLnZhdWx0Lm1vZGlmeShmaWxlLCByZXN1bHQuY29udGVudCk7XHJcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQuY291bnQ7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgcHJvY2Vzc1JlZ2V4KHN1YmplY3Q6IHN0cmluZywgcnVsZVRleHQ6IHN0cmluZywgcnVsZXNldE5hbWU6IHN0cmluZyk6IHsgY29udGVudDogc3RyaW5nLCBjb3VudDogbnVtYmVyIH0ge1xyXG4gICAgICAgIGNvbnN0IHJ1bGVQYXJzZXIgPSAvXlwiKC4rPylcIihbYS16XSo/KSg/OlxcclxcbnxcXHJ8XFxuKT8tPig/OlxcclxcbnxcXHJ8XFxuKT9cIiguKj8pXCIoW2Etel0qPykoPzpcXHJcXG58XFxyfFxcbik/JC9nbXVzO1xyXG4gICAgICAgIGxldCBjb3VudCA9IDA7XHJcbiAgICAgICAgbGV0IHJ1bGVNYXRjaGVzO1xyXG4gICAgICAgIGxldCBvdXRwdXQgPSBzdWJqZWN0O1xyXG4gICAgICAgIHdoaWxlICgocnVsZU1hdGNoZXMgPSBydWxlUGFyc2VyLmV4ZWMocnVsZVRleHQpKSAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICBjb25zdCBbICwgcGF0dGVybiwgZmxhZ3MsIHJlcGxhY2VtZW50LCBtb2RlIF0gPSBydWxlTWF0Y2hlcztcclxuICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG1hdGNoUnVsZSA9IG5ldyBSZWdFeHAocGF0dGVybiwgZmxhZ3MgfHwgJ2dtJyk7XHJcbiAgICAgICAgICAgICAgICBvdXRwdXQgPSBtb2RlID09PSAneCcgPyBvdXRwdXQucmVwbGFjZShtYXRjaFJ1bGUsICcnKSA6IG91dHB1dC5yZXBsYWNlKG1hdGNoUnVsZSwgcmVwbGFjZW1lbnQpO1xyXG4gICAgICAgICAgICAgICAgY291bnQrKztcclxuICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihgUmVnZXggUXVpY2sgQWN0aW9uczogSW52YWxpZCBSZWdleCBpbiAke3J1bGVzZXROYW1lfWAsIGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB7IGNvbnRlbnQ6IG91dHB1dCwgY291bnQgfTtcclxuICAgIH1cclxuXHJcbiAgICBhc3luYyBhcHBseVJ1bGVzZXQocnVsZXNldFBhdGg6IHN0cmluZykge1xyXG4gICAgICAgIGlmICghYXdhaXQgdGhpcy5hcHAudmF1bHQuYWRhcHRlci5leGlzdHMocnVsZXNldFBhdGgpKSB7XHJcbiAgICAgICAgICAgIG5ldyBOb3RpY2UocnVsZXNldFBhdGggKyB0KCdOT1RfRk9VTkRfRVJSJykpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IHJ1bGVUZXh0ID0gYXdhaXQgdGhpcy5hcHAudmF1bHQuYWRhcHRlci5yZWFkKHJ1bGVzZXRQYXRoKTtcclxuICAgICAgICBjb25zdCBhY3RpdmVNYXJrZG93blZpZXcgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xyXG4gICAgICAgIGlmICghYWN0aXZlTWFya2Rvd25WaWV3KSByZXR1cm47XHJcbiAgICAgICAgY29uc3QgZWRpdG9yID0gYWN0aXZlTWFya2Rvd25WaWV3LmVkaXRvcjtcclxuICAgICAgICBcclxuICAgICAgICBjb25zdCBzdWJqZWN0ID0gZWRpdG9yLnNvbWV0aGluZ1NlbGVjdGVkKCkgPyBlZGl0b3IuZ2V0U2VsZWN0aW9uKCkgOiBlZGl0b3IuZ2V0VmFsdWUoKTtcclxuICAgICAgICBcclxuICAgICAgICBjb25zdCBwb3MgPSBlZGl0b3IuZ2V0U2Nyb2xsSW5mbygpO1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IHRoaXMucHJvY2Vzc1JlZ2V4KHN1YmplY3QsIHJ1bGVUZXh0LCBydWxlc2V0UGF0aCk7XHJcbiAgICAgICAgaWYgKGVkaXRvci5zb21ldGhpbmdTZWxlY3RlZCgpKSBlZGl0b3IucmVwbGFjZVNlbGVjdGlvbihyZXN1bHQuY29udGVudCk7XHJcbiAgICAgICAgZWxzZSBlZGl0b3Iuc2V0VmFsdWUocmVzdWx0LmNvbnRlbnQpO1xyXG4gICAgICAgIGVkaXRvci5zY3JvbGxUbygwLCBwb3MudG9wKTtcclxuICAgICAgICBuZXcgTm90aWNlKHQoJ0VYRUNVVEVEX01TRycsIHJ1bGVzZXRQYXRoLnNwbGl0KCcvJykucG9wKCkgfHwgJycsIHJlc3VsdC5jb3VudCkpO1xyXG4gICAgfVxyXG59XHJcblxyXG5jbGFzcyBDb25maXJtYXRpb25Nb2RhbCBleHRlbmRzIE1vZGFsIHtcclxuICAgIGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwcml2YXRlIHRpdGxlOiBzdHJpbmcsIHByaXZhdGUgbWVzc2FnZTogc3RyaW5nLCBwcml2YXRlIGNvbmZpcm1CdG5UZXh0OiBzdHJpbmcsIHByaXZhdGUgb25Db25maXJtOiAoKSA9PiB2b2lkKSB7XHJcbiAgICAgICAgc3VwZXIoYXBwKTtcclxuICAgIH1cclxuICAgIG9uT3BlbigpIHtcclxuICAgICAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcclxuICAgICAgICB0aGlzLnRpdGxlRWwuc2V0VGV4dCh0aGlzLnRpdGxlKTtcclxuICAgICAgICBjb250ZW50RWwuY3JlYXRlRWwoXCJwXCIsIHsgdGV4dDogdGhpcy5tZXNzYWdlIH0pO1xyXG4gICAgICAgIGNvbnN0IGJ0bkNvbnRhaW5lciA9IGNvbnRlbnRFbC5jcmVhdGVFbChcImRpdlwiLCB7IGNsczogXCJvcnAtbW9kYWwtYnV0dG9uc1wiIH0pO1xyXG4gICAgICAgIG5ldyBCdXR0b25Db21wb25lbnQoYnRuQ29udGFpbmVyKS5zZXRCdXR0b25UZXh0KHQoJ0NBTkNFTCcpKS5vbkNsaWNrKCgpID0+IHRoaXMuY2xvc2UoKSk7XHJcbiAgICAgICAgbmV3IEJ1dHRvbkNvbXBvbmVudChidG5Db250YWluZXIpLnNldEJ1dHRvblRleHQodGhpcy5jb25maXJtQnRuVGV4dCkuc2V0V2FybmluZygpLm9uQ2xpY2soKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLm9uQ29uZmlybSgpO1xyXG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBvbkNsb3NlKCkgeyB0aGlzLmNvbnRlbnRFbC5lbXB0eSgpOyB9XHJcbn1cclxuXHJcbmNsYXNzIFJlZ2V4UXVpY2tBY3Rpb25zU2V0dGluZ3NUYWIgZXh0ZW5kcyBQbHVnaW5TZXR0aW5nVGFiIHtcclxuICAgIHBsdWdpbjogUmVnZXhRdWlja0FjdGlvbnM7XHJcbiAgICBzaG93Q3JlYXRpb25Gb3JtID0gZmFsc2U7XHJcbiAgICBlZGl0aW5nUnVsZTogc3RyaW5nIHwgbnVsbCA9IG51bGw7XHJcbiAgICB0ZW1wTmFtZSA9IFwiXCI7XHJcbiAgICB0ZW1wUGF0dGVybiA9IFwiXCI7XHJcbiAgICB0ZW1wRmxhZ3MgPSBcImdtXCI7XHJcbiAgICB0ZW1wUmVwbGFjZW1lbnQgPSBcIlwiO1xyXG4gICAgdGVtcElzRGVmYXVsdCA9IGZhbHNlO1xyXG5cclxuICAgIG5hbWVJbnB1dEVsOiBIVE1MSW5wdXRFbGVtZW50O1xyXG4gICAgcGF0dGVybklucHV0RWw6IEhUTUxJbnB1dEVsZW1lbnQ7XHJcbiAgICBmbGFnc0lucHV0RWw6IEhUTUxJbnB1dEVsZW1lbnQ7XHJcblxyXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIHBsdWdpbjogUmVnZXhRdWlja0FjdGlvbnMpIHtcclxuICAgICAgICBzdXBlcihhcHAsIHBsdWdpbik7XHJcbiAgICAgICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XHJcbiAgICB9XHJcblxyXG4gICAgZGlzcGxheSgpIHtcclxuICAgICAgICBjb25zdCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xyXG4gICAgICAgIGNvbnRhaW5lckVsLmVtcHR5KCk7XHJcblxyXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAgICAgICAuc2V0SGVhZGluZygpXHJcbiAgICAgICAgICAgIC5zZXROYW1lKHQoJ1BMVUdJTl9TRVRUSU5HU19IRUFERVInKSk7XHJcblxyXG4gICAgICAgIGNvbnRhaW5lckVsLmNyZWF0ZUVsKFwicFwiLCB7IHRleHQ6IHQoJ1BMVUdJTl9ERVNDJyksIGNsczogXCJvcnAtc2V0dGluZ3MtZGVzY3JpcHRpb25cIiB9KTtcclxuXHJcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgICAgICAgIC5zZXRIZWFkaW5nKClcclxuICAgICAgICAgICAgLnNldE5hbWUodCgnR0VORVJBTF9TRUNUSU9OX0hFQURFUicpKTtcclxuXHJcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgICAgICAgIC5zZXROYW1lKHQoJ0NPTkZJUk1fRk9MREVSX0FDVElPTicpKVxyXG4gICAgICAgICAgICAuc2V0RGVzYyh0KCdDT05GSVJNX0ZPTERFUl9BQ1RJT05fREVTQycpKVxyXG4gICAgICAgICAgICAuYWRkVG9nZ2xlKHRvZ2dsZSA9PiB0b2dnbGVcclxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5jb25maXJtRm9sZGVyQWN0aW9uKVxyXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmNvbmZpcm1Gb2xkZXJBY3Rpb24gPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgICAgIH0pKTtcclxuXHJcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgICAgICAgIC5zZXRIZWFkaW5nKClcclxuICAgICAgICAgICAgLnNldE5hbWUodCgnTUFOQUdFX1NFQ1RJT05fSEVBREVSJykpO1xyXG5cclxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgICAgICAgLnNldE5hbWUodCgnQUREX1FVSUNLX0FDVElPTicpKVxyXG4gICAgICAgICAgICAuYWRkQnV0dG9uKGJ0biA9PiBidG5cclxuICAgICAgICAgICAgICAgIC5zZXRCdXR0b25UZXh0KHQoJ0FERCcpKVxyXG4gICAgICAgICAgICAgICAgLnNldEN0YSgpXHJcbiAgICAgICAgICAgICAgICAub25DbGljaygoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXNldFRlbXBGaWVsZHMoKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3dDcmVhdGlvbkZvcm0gPSAhdGhpcy5zaG93Q3JlYXRpb25Gb3JtO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGlzcGxheSgpO1xyXG4gICAgICAgICAgICAgICAgfSkpO1xyXG5cclxuICAgICAgICBpZiAodGhpcy5zaG93Q3JlYXRpb25Gb3JtKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGZvcm1Db250YWluZXIgPSBjb250YWluZXJFbC5jcmVhdGVFbChcImRpdlwiLCB7IGNsczogXCJvcnAtY3JlYXRpb24tcm93XCIgfSk7XHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyRm9ybUZpZWxkcyhmb3JtQ29udGFpbmVyLCAoKSA9PiB0aGlzLmhhbmRsZVNhdmUoKSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBsaXN0V3JhcHBlciA9IGNvbnRhaW5lckVsLmNyZWF0ZUVsKFwiZGl2XCIsIHsgY2xzOiBcIm9ycC1zYXZlZC1saXN0XCIgfSk7XHJcbiAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MucnVsZXMuZm9yRWFjaChhc3luYyBuYW1lID0+IHtcclxuICAgICAgICAgICAgY29uc3QgaXRlbVJvdyA9IGxpc3RXcmFwcGVyLmNyZWF0ZUVsKFwiZGl2XCIsIHsgY2xzOiBcIm9ycC1zYXZlZC1ydWxlLWl0ZW1cIiB9KTtcclxuICAgICAgICAgICAgaWYgKHRoaXMuZWRpdGluZ1J1bGUgPT09IG5hbWUpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyRm9ybUZpZWxkcyhpdGVtUm93LCAoKSA9PiB0aGlzLmhhbmRsZVVwZGF0ZShuYW1lKSwgdHJ1ZSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgY29udGVudCA9IFwiXCI7XHJcbiAgICAgICAgICAgICAgICAvLyBGSVhFRDogYWRkZWQgY29tbWVudCB0byBlbXB0eSBjYXRjaCBibG9jayB0byBzYXRpc2Z5IG5vLWVtcHR5IGxpbnRlciBydWxlXHJcbiAgICAgICAgICAgICAgICB0cnkgeyBjb250ZW50ID0gYXdhaXQgdGhpcy5wbHVnaW4uYXBwLnZhdWx0LmFkYXB0ZXIucmVhZCh0aGlzLnBsdWdpbi5wYXRoVG9SdWxlc2V0cyArIFwiL1wiICsgbmFtZSk7IH0gY2F0Y2ggeyAvKiBpZ25vcmUgaWYgZmlsZSBkb2Vzbid0IGV4aXN0ICovIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IHsgcGF0dGVybiwgZmxhZ3MsIHJlcGxhY2VtZW50IH0gPSB0aGlzLnBhcnNlUnVsZUNvbnRlbnQoY29udGVudCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuYW1lV3JhcCA9IGl0ZW1Sb3cuY3JlYXRlRWwoXCJkaXZcIiwgeyBjbHM6IFwib3JwLWlucHV0LXdyYXAgb3JwLW5hbWUtZmllbGRcIiB9KTtcclxuICAgICAgICAgICAgICAgIG5hbWVXcmFwLmNyZWF0ZUVsKFwic21hbGxcIiwgeyB0ZXh0OiB0KCdBQ1RJT05fTkFNRScpLCBjbHM6IFwib3JwLWxhYmVsXCIgfSk7XHJcbiAgICAgICAgICAgICAgICBuYW1lV3JhcC5jcmVhdGVFbChcImRpdlwiLCB7IHRleHQ6IG5hbWUsIGNsczogXCJvcnAtc2F2ZWQtdGV4dC1kaXNwbGF5XCIgfSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBmaWVsZHNSb3cgPSBpdGVtUm93LmNyZWF0ZUVsKFwiZGl2XCIsIHsgY2xzOiBcIm9ycC1maWVsZHMtcm93XCIgfSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNyZWF0ZURpc3BsYXlGaWVsZChmaWVsZHNSb3csIHQoJ1NFQVJDSF9SRUdFWCcpLCBwYXR0ZXJuLCBcIm9ycC1wYXR0ZXJuLWZpZWxkXCIpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jcmVhdGVEaXNwbGF5RmllbGQoZmllbGRzUm93LCB0KCdGTEFHUycpLCBmbGFncywgXCJvcnAtZmxhZ3MtZmllbGRcIik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNyZWF0ZURpc3BsYXlGaWVsZChmaWVsZHNSb3csIHQoJ1JFUExBQ0VNRU5UJyksIHJlcGxhY2VtZW50LCBcIm9ycC1yZXBsYWNlbWVudC1maWVsZFwiKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGFjdGlvbnNXcmFwID0gaXRlbVJvdy5jcmVhdGVFbChcImRpdlwiLCB7IGNsczogXCJvcnAtaW5wdXQtd3JhcCBvcnAtY3JlYXRpb24tYWN0aW9uc1wiIH0pO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZGVmYXVsdFdyYXAgPSBhY3Rpb25zV3JhcC5jcmVhdGVFbChcImRpdlwiLCB7IGNsczogXCJvcnAtZGVmYXVsdC10b2dnbGUtd3JhcFwiIH0pO1xyXG4gICAgICAgICAgICAgICAgbmV3IFRvZ2dsZUNvbXBvbmVudChkZWZhdWx0V3JhcClcclxuICAgICAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuZGVmYXVsdFJ1bGUgPT09IG5hbWUpXHJcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5kZWZhdWx0UnVsZSA9IHZhbHVlID8gbmFtZSA6IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc3BsYXkoKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGRlZmF1bHRXcmFwLmNyZWF0ZVNwYW4oeyB0ZXh0OiB0KCdTRVRfQVNfREVGQVVMVCcpLCBjbHM6IFwib3JwLXRvZ2dsZS1sYWJlbFwiIH0pO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgYnV0dG9ucyA9IGFjdGlvbnNXcmFwLmNyZWF0ZUVsKFwiZGl2XCIsIHsgY2xzOiBcIm9ycC1hY3Rpb24tYnV0dG9uc1wiIH0pO1xyXG4gICAgICAgICAgICAgICAgbmV3IEJ1dHRvbkNvbXBvbmVudChidXR0b25zKS5zZXRCdXR0b25UZXh0KHQoJ0VESVQnKSkub25DbGljaygoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wYXJzZUNvbnRlbnRUb0ZpZWxkcyhuYW1lLCBjb250ZW50KTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmVkaXRpbmdSdWxlID0gbmFtZTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3dDcmVhdGlvbkZvcm0gPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc3BsYXkoKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgbmV3IEJ1dHRvbkNvbXBvbmVudChidXR0b25zKS5zZXRCdXR0b25UZXh0KHQoJ0RFTEVURScpKS5zZXRXYXJuaW5nKCkub25DbGljaygoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgbmV3IENvbmZpcm1hdGlvbk1vZGFsKHRoaXMuYXBwLCB0KCdERUxFVEVfSEVBREVSJyksIHQoJ0RFTEVURV9DT05GSVJNJywgbmFtZSksIHQoJ1lFUycpLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLmRlbGV0ZVJ1bGVzZXQobmFtZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGlzcGxheSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pLm9wZW4oKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBjcmVhdGVEaXNwbGF5RmllbGQocGFyZW50OiBIVE1MRWxlbWVudCwgbGFiZWw6IHN0cmluZywgdmFsOiBzdHJpbmcsIGNsczogc3RyaW5nKSB7XHJcbiAgICAgICAgY29uc3Qgd3JhcCA9IHBhcmVudC5jcmVhdGVFbChcImRpdlwiLCB7IGNsczogYG9ycC1pbnB1dC13cmFwICR7Y2xzfWAgfSk7XHJcbiAgICAgICAgd3JhcC5jcmVhdGVFbChcInNtYWxsXCIsIHsgdGV4dDogbGFiZWwsIGNsczogXCJvcnAtbGFiZWxcIiB9KTtcclxuICAgICAgICB3cmFwLmNyZWF0ZUVsKFwiZGl2XCIsIHsgdGV4dDogdmFsLCBjbHM6IFwib3JwLXNhdmVkLXRleHQtZGlzcGxheVwiIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgcmVuZGVyRm9ybUZpZWxkcyhjb250YWluZXI6IEhUTUxFbGVtZW50LCBvbkNvbmZpcm06ICgpID0+IHZvaWQsIGlzVXBkYXRlID0gZmFsc2UpIHtcclxuICAgICAgICBjb25zdCBuYW1lV3JhcCA9IGNvbnRhaW5lci5jcmVhdGVFbChcImRpdlwiLCB7IGNsczogXCJvcnAtaW5wdXQtd3JhcCBvcnAtbmFtZS1maWVsZFwiIH0pO1xyXG4gICAgICAgIG5hbWVXcmFwLmNyZWF0ZUVsKFwic21hbGxcIiwgeyB0ZXh0OiB0KCdBQ1RJT05fTkFNRScpLCBjbHM6IFwib3JwLWxhYmVsXCIgfSk7XHJcbiAgICAgICAgdGhpcy5uYW1lSW5wdXRFbCA9IG5hbWVXcmFwLmNyZWF0ZUVsKFwiaW5wdXRcIiwgeyB0eXBlOiBcInRleHRcIiwgdmFsdWU6IHRoaXMudGVtcE5hbWUsIHBsYWNlaG9sZGVyOiB0KCdQTEFDRUhPTERFUl9OQU1FJyksIGNsczogXCJvcnAtaW5wdXRcIiB9KTtcclxuICAgICAgICB0aGlzLm5hbWVJbnB1dEVsLmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoZSkgPT4gdGhpcy50ZW1wTmFtZSA9IChlLnRhcmdldCBhcyBIVE1MSW5wdXRFbGVtZW50KS52YWx1ZSk7XHJcblxyXG4gICAgICAgIGNvbnN0IGZpZWxkc1JvdyA9IGNvbnRhaW5lci5jcmVhdGVFbChcImRpdlwiLCB7IGNsczogXCJvcnAtZmllbGRzLXJvd1wiIH0pO1xyXG4gICAgICAgIHRoaXMucGF0dGVybklucHV0RWwgPSB0aGlzLmNyZWF0ZUlucHV0RmllbGQoZmllbGRzUm93LCB0KCdTRUFSQ0hfUkVHRVgnKSwgdGhpcy50ZW1wUGF0dGVybiwgdCgnUExBQ0VIT0xERVJfU0VBUkNIJyksIFwib3JwLXBhdHRlcm4tZmllbGRcIiwgKHYpID0+IHRoaXMudGVtcFBhdHRlcm4gPSB2KTtcclxuICAgICAgICB0aGlzLmZsYWdzSW5wdXRFbCA9IHRoaXMuY3JlYXRlSW5wdXRGaWVsZChmaWVsZHNSb3csIHQoJ0ZMQUdTJyksIHRoaXMudGVtcEZsYWdzLCB0KCdQTEFDRUhPTERFUl9GTEFHUycpLCBcIm9ycC1mbGFncy1maWVsZFwiLCAodikgPT4gdGhpcy50ZW1wRmxhZ3MgPSB2KTtcclxuICAgICAgICB0aGlzLmNyZWF0ZUlucHV0RmllbGQoZmllbGRzUm93LCB0KCdSRVBMQUNFTUVOVCcpLCB0aGlzLnRlbXBSZXBsYWNlbWVudCwgdCgnUExBQ0VIT0xERVJfUkVQTEFDRU1FTlQnKSwgXCJvcnAtcmVwbGFjZW1lbnQtZmllbGRcIiwgKHYpID0+IHRoaXMudGVtcFJlcGxhY2VtZW50ID0gdik7XHJcblxyXG4gICAgICAgIGNvbnN0IGFjdGlvbnNXcmFwID0gY29udGFpbmVyLmNyZWF0ZUVsKFwiZGl2XCIsIHsgY2xzOiBcIm9ycC1pbnB1dC13cmFwIG9ycC1jcmVhdGlvbi1hY3Rpb25zXCIgfSk7XHJcbiAgICAgICAgY29uc3QgZGVmYXVsdFdyYXAgPSBhY3Rpb25zV3JhcC5jcmVhdGVFbChcImRpdlwiLCB7IGNsczogXCJvcnAtZGVmYXVsdC10b2dnbGUtd3JhcFwiIH0pO1xyXG4gICAgICAgIGNvbnN0IGluaXRpYWxUb2dnbGVWYWx1ZSA9IGlzVXBkYXRlID8gKHRoaXMucGx1Z2luLnNldHRpbmdzLmRlZmF1bHRSdWxlID09PSB0aGlzLmVkaXRpbmdSdWxlKSA6IHRoaXMudGVtcElzRGVmYXVsdDtcclxuICAgICAgICBuZXcgVG9nZ2xlQ29tcG9uZW50KGRlZmF1bHRXcmFwKVxyXG4gICAgICAgICAgICAuc2V0VmFsdWUoaW5pdGlhbFRvZ2dsZVZhbHVlKVxyXG4gICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoaXNVcGRhdGUpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5kZWZhdWx0UnVsZSA9IHZhbHVlID8gdGhpcy50ZW1wTmFtZSA6IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudGVtcElzRGVmYXVsdCA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICBkZWZhdWx0V3JhcC5jcmVhdGVTcGFuKHsgdGV4dDogdCgnU0VUX0FTX0RFRkFVTFQnKSwgY2xzOiBcIm9ycC10b2dnbGUtbGFiZWxcIiB9KTtcclxuICAgICAgICBjb25zdCBidXR0b25zID0gYWN0aW9uc1dyYXAuY3JlYXRlRWwoXCJkaXZcIiwgeyBjbHM6IFwib3JwLWFjdGlvbi1idXR0b25zXCIgfSk7XHJcbiAgICAgICAgbmV3IEJ1dHRvbkNvbXBvbmVudChidXR0b25zKS5zZXRCdXR0b25UZXh0KGlzVXBkYXRlID8gdCgnU0FWRScpIDogdCgnU0FWRScpKS5zZXRDdGEoKS5vbkNsaWNrKG9uQ29uZmlybSk7XHJcbiAgICAgICAgbmV3IEJ1dHRvbkNvbXBvbmVudChidXR0b25zKS5zZXRCdXR0b25UZXh0KHQoJ0NBTkNFTCcpKS5vbkNsaWNrKCgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5lZGl0aW5nUnVsZSA9IG51bGw7XHJcbiAgICAgICAgICAgIHRoaXMuc2hvd0NyZWF0aW9uRm9ybSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB0aGlzLmRpc3BsYXkoKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGNyZWF0ZUlucHV0RmllbGQocGFyZW50OiBIVE1MRWxlbWVudCwgbGFiZWw6IHN0cmluZywgdmFsOiBzdHJpbmcsIHBoOiBzdHJpbmcsIGNsczogc3RyaW5nLCBvbkNoYW5nZTogKHY6IHN0cmluZykgPT4gdm9pZCk6IEhUTUxJbnB1dEVsZW1lbnQge1xyXG4gICAgICAgIGNvbnN0IHdyYXAgPSBwYXJlbnQuY3JlYXRlRWwoXCJkaXZcIiwgeyBjbHM6IGBvcnAtaW5wdXQtd3JhcCAke2Nsc31gIH0pO1xyXG4gICAgICAgIHdyYXAuY3JlYXRlRWwoXCJzbWFsbFwiLCB7IHRleHQ6IGxhYmVsLCBjbHM6IFwib3JwLWxhYmVsXCIgfSk7XHJcbiAgICAgICAgY29uc3QgaW5wdXQgPSB3cmFwLmNyZWF0ZUVsKFwiaW5wdXRcIiwgeyB0eXBlOiBcInRleHRcIiwgdmFsdWU6IHZhbCwgcGxhY2Vob2xkZXI6IHBoLCBjbHM6IFwib3JwLWlucHV0XCIgfSk7XHJcbiAgICAgICAgaW5wdXQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsIChlKSA9PiBvbkNoYW5nZSgoZS50YXJnZXQgYXMgSFRNTElucHV0RWxlbWVudCkudmFsdWUpKTtcclxuICAgICAgICByZXR1cm4gaW5wdXQ7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSB0cmlnZ2VyRmllbGRFcnJvcihlbDogSFRNTEVsZW1lbnQpIHtcclxuICAgICAgICBpZiAoIWVsKSByZXR1cm47XHJcbiAgICAgICAgZWwuY2xhc3NMaXN0LnJlbW92ZSgnZmllbGQtZXJyb3InKTtcclxuICAgICAgICB2b2lkIGVsLm9mZnNldFdpZHRoO1xyXG4gICAgICAgIGVsLmNsYXNzTGlzdC5hZGQoJ2ZpZWxkLWVycm9yJyk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSB2YWxpZGF0ZUlucHV0cyhpc1VwZGF0ZSA9IGZhbHNlKTogYm9vbGVhbiB7XHJcbiAgICAgICAgY29uc3QgdHJpbW1lZE5hbWUgPSB0aGlzLnRlbXBOYW1lLnRyaW0oKTtcclxuICAgICAgICBpZiAoIXRyaW1tZWROYW1lKSB7XHJcbiAgICAgICAgICAgIG5ldyBOb3RpY2UodCgnTkFNRV9FTVBUWV9FUlInKSk7XHJcbiAgICAgICAgICAgIHRoaXMudHJpZ2dlckZpZWxkRXJyb3IodGhpcy5uYW1lSW5wdXRFbCk7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IG5hbWVFeGlzdHMgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5ydWxlcy5zb21lKG5hbWUgPT4gXHJcbiAgICAgICAgICAgIG5hbWUudG9Mb3dlckNhc2UoKSA9PT0gdHJpbW1lZE5hbWUudG9Mb3dlckNhc2UoKSAmJiAoIWlzVXBkYXRlIHx8IG5hbWUgIT09IHRoaXMuZWRpdGluZ1J1bGUpXHJcbiAgICAgICAgKTtcclxuICAgICAgICBpZiAobmFtZUV4aXN0cykge1xyXG4gICAgICAgICAgICBuZXcgTm90aWNlKHQoJ05BTUVfRVhJU1RTX0VSUicpKTtcclxuICAgICAgICAgICAgdGhpcy50cmlnZ2VyRmllbGRFcnJvcih0aGlzLm5hbWVJbnB1dEVsKTtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKCF0aGlzLnRlbXBQYXR0ZXJuLnRyaW0oKSkge1xyXG4gICAgICAgICAgICBuZXcgTm90aWNlKHQoJ1BBVFRFUk5fRU1QVFlfRVJSJykpO1xyXG4gICAgICAgICAgICB0aGlzLnRyaWdnZXJGaWVsZEVycm9yKHRoaXMucGF0dGVybklucHV0RWwpO1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBuZXcgUmVnRXhwKHRoaXMudGVtcFBhdHRlcm4sIHRoaXMudGVtcEZsYWdzIHx8ICdnbScpO1xyXG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgY29uc3QgZXJyb3JNc2cgPSBlIGluc3RhbmNlb2YgRXJyb3IgPyBlLm1lc3NhZ2UudG9Mb3dlckNhc2UoKSA6IFN0cmluZyhlKS50b0xvd2VyQ2FzZSgpO1xyXG4gICAgICAgICAgICBjb25zdCBpc0ZsYWdFcnJvciA9IGVycm9yTXNnLmluY2x1ZGVzKFwiZmxhZ1wiKSB8fCAvW15naW1zdXldLy50ZXN0KHRoaXMudGVtcEZsYWdzKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGlmIChpc0ZsYWdFcnJvcikge1xyXG4gICAgICAgICAgICAgICAgbmV3IE5vdGljZSh0KCdGTEFHU19JTlZBTElEX0VSUicpKTtcclxuICAgICAgICAgICAgICAgIHRoaXMudHJpZ2dlckZpZWxkRXJyb3IodGhpcy5mbGFnc0lucHV0RWwpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgbmV3IE5vdGljZSh0KCdSRUdFWF9JTlZBTElEX0VSUicpKTtcclxuICAgICAgICAgICAgICAgIHRoaXMudHJpZ2dlckZpZWxkRXJyb3IodGhpcy5wYXR0ZXJuSW5wdXRFbCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGFzeW5jIGhhbmRsZVNhdmUoKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLnZhbGlkYXRlSW5wdXRzKGZhbHNlKSkgcmV0dXJuO1xyXG4gICAgICAgIGNvbnN0IGNvbnRlbnQgPSBgXCIke3RoaXMudGVtcFBhdHRlcm59XCIke3RoaXMudGVtcEZsYWdzfVxcbi0+XFxuXCIke3RoaXMudGVtcFJlcGxhY2VtZW50fVwiYDtcclxuICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5jcmVhdGVSdWxlc2V0KHRoaXMudGVtcE5hbWUsIGNvbnRlbnQpO1xyXG4gICAgICAgIGlmICh0aGlzLnRlbXBJc0RlZmF1bHQpIHtcclxuICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZGVmYXVsdFJ1bGUgPSB0aGlzLnRlbXBOYW1lO1xyXG4gICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5zaG93Q3JlYXRpb25Gb3JtID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5kaXNwbGF5KCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBhc3luYyBoYW5kbGVVcGRhdGUob2xkTmFtZTogc3RyaW5nKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLnZhbGlkYXRlSW5wdXRzKHRydWUpKSByZXR1cm47XHJcbiAgICAgICAgY29uc3QgY29udGVudCA9IGBcIiR7dGhpcy50ZW1wUGF0dGVybn1cIiR7dGhpcy50ZW1wRmxhZ3N9XFxuLT5cXG5cIiR7dGhpcy50ZW1wUmVwbGFjZW1lbnR9XCJgO1xyXG4gICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnVwZGF0ZVJ1bGVzZXQob2xkTmFtZSwgdGhpcy50ZW1wTmFtZSwgY29udGVudCk7XHJcbiAgICAgICAgdGhpcy5lZGl0aW5nUnVsZSA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5kaXNwbGF5KCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBwYXJzZVJ1bGVDb250ZW50KGNvbnRlbnQ6IHN0cmluZykge1xyXG4gICAgICAgIGNvbnN0IHBhcnNlciA9IC9eXCIoLis/KVwiKFthLXpdKj8pKD86XFxyXFxufFxccnxcXG4pPy0+KD86XFxyXFxufFxccnxcXG4pP1wiKC4qPylcIihbYS16XSo/KSQvbXVzO1xyXG4gICAgICAgIGNvbnN0IG1hdGNoID0gcGFyc2VyLmV4ZWMoY29udGVudCk7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgcGF0dGVybjogbWF0Y2ggPyBtYXRjaFsxXSA6IFwiXCIsXHJcbiAgICAgICAgICAgIGZsYWdzOiBtYXRjaCA/IG1hdGNoWzJdIDogXCJnbVwiLFxyXG4gICAgICAgICAgICByZXBsYWNlbWVudDogbWF0Y2ggPyBtYXRjaFszXSA6IFwiXCJcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgcGFyc2VDb250ZW50VG9GaWVsZHMobmFtZTogc3RyaW5nLCBjb250ZW50OiBzdHJpbmcpIHtcclxuICAgICAgICBjb25zdCBkYXRhID0gdGhpcy5wYXJzZVJ1bGVDb250ZW50KGNvbnRlbnQpO1xyXG4gICAgICAgIHRoaXMudGVtcE5hbWUgPSBuYW1lO1xyXG4gICAgICAgIHRoaXMudGVtcFBhdHRlcm4gPSBkYXRhLnBhdHRlcm47XHJcbiAgICAgICAgdGhpcy50ZW1wRmxhZ3MgPSBkYXRhLmZsYWdzO1xyXG4gICAgICAgIHRoaXMudGVtcFJlcGxhY2VtZW50ID0gZGF0YS5yZXBsYWNlbWVudDtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHJlc2V0VGVtcEZpZWxkcygpIHtcclxuICAgICAgICB0aGlzLnRlbXBOYW1lID0gXCJcIjtcclxuICAgICAgICB0aGlzLnRlbXBQYXR0ZXJuID0gXCJcIjtcclxuICAgICAgICB0aGlzLnRlbXBGbGFncyA9IFwiZ21cIjtcclxuICAgICAgICB0aGlzLnRlbXBSZXBsYWNlbWVudCA9IFwiXCI7XHJcbiAgICAgICAgdGhpcy50ZW1wSXNEZWZhdWx0ID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5lZGl0aW5nUnVsZSA9IG51bGw7XHJcbiAgICB9XHJcbn0iXSwibmFtZXMiOlsibW9tZW50IiwiUGx1Z2luIiwiVEZpbGUiLCJURm9sZGVyIiwiTWFya2Rvd25WaWV3IiwiTm90aWNlIiwiTW9kYWwiLCJCdXR0b25Db21wb25lbnQiLCJQbHVnaW5TZXR0aW5nVGFiIiwiU2V0dGluZyIsIlRvZ2dsZUNvbXBvbmVudCJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQW9HQTtBQUNPLFNBQVMsU0FBUyxDQUFDLE9BQU8sRUFBRSxVQUFVLEVBQUUsQ0FBQyxFQUFFLFNBQVMsRUFBRTtBQUM3RCxJQUFJLFNBQVMsS0FBSyxDQUFDLEtBQUssRUFBRSxFQUFFLE9BQU8sS0FBSyxZQUFZLENBQUMsR0FBRyxLQUFLLEdBQUcsSUFBSSxDQUFDLENBQUMsVUFBVSxPQUFPLEVBQUUsRUFBRSxPQUFPLENBQUMsS0FBSyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsRUFBRTtBQUNoSCxJQUFJLE9BQU8sS0FBSyxDQUFDLEtBQUssQ0FBQyxHQUFHLE9BQU8sQ0FBQyxFQUFFLFVBQVUsT0FBTyxFQUFFLE1BQU0sRUFBRTtBQUMvRCxRQUFRLFNBQVMsU0FBUyxDQUFDLEtBQUssRUFBRSxFQUFFLElBQUksRUFBRSxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxPQUFPLENBQUMsRUFBRSxFQUFFLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLEVBQUU7QUFDbkcsUUFBUSxTQUFTLFFBQVEsQ0FBQyxLQUFLLEVBQUUsRUFBRSxJQUFJLEVBQUUsSUFBSSxDQUFDLFNBQVMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxPQUFPLENBQUMsRUFBRSxFQUFFLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLEVBQUU7QUFDdEcsUUFBUSxTQUFTLElBQUksQ0FBQyxNQUFNLEVBQUUsRUFBRSxNQUFNLENBQUMsSUFBSSxHQUFHLE9BQU8sQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLEdBQUcsS0FBSyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQyxJQUFJLENBQUMsU0FBUyxFQUFFLFFBQVEsQ0FBQyxDQUFDLEVBQUU7QUFDdEgsUUFBUSxJQUFJLENBQUMsQ0FBQyxTQUFTLEdBQUcsU0FBUyxDQUFDLEtBQUssQ0FBQyxPQUFPLEVBQUUsVUFBVSxJQUFJLEVBQUUsQ0FBQyxFQUFFLElBQUksRUFBRSxDQUFDLENBQUM7QUFDOUUsS0FBSyxDQUFDLENBQUM7QUFDUCxDQUFDO0FBNk1EO0FBQ3VCLE9BQU8sZUFBZSxLQUFLLFVBQVUsR0FBRyxlQUFlLEdBQUcsVUFBVSxLQUFLLEVBQUUsVUFBVSxFQUFFLE9BQU8sRUFBRTtBQUN2SCxJQUFJLElBQUksQ0FBQyxHQUFHLElBQUksS0FBSyxDQUFDLE9BQU8s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
